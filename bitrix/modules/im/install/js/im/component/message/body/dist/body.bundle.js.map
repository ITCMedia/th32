{"version":3,"file":"body.bundle.js","sources":["../src/body.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Message Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './body.css';\nimport 'im.component.element.media';\nimport 'im.component.element.attach';\nimport 'im.component.element.keyboard';\nimport 'ui.vue.components.reaction';\n\nimport {Vue} from \"ui.vue\";\nimport {DialoguesModel, FilesModel, MessagesModel, UsersModel} from 'im.model';\nimport {DialogType, MessageType} from \"im.const\";\nimport {Utils} from \"im.utils\";\n\nconst BX = window.BX;\n\nconst ContentType = Object.freeze({\n\tdefault: 'default',\n\tprogress: 'progress',\n\timage: 'image',\n\taudio: 'audio',\n\tvideo: 'video',\n\trichLink: 'richLink',\n});\n\nVue.component('bx-messenger-message-body',\n{\n\t/**\n\t * @emits 'clickByUserName' {user: object, event: MouseEvent}\n\t * @emits 'clickByUploadCancel' {file: object, event: MouseEvent}\n\t * @emits 'clickByKeyboardButton' {message: object, action: string, params: Object}\n\t * @emits 'setReaction' {message: object, reaction: object}\n\t * @emits 'openReactionList' {message: object, values: object}\n\t */\n\tprops:\n\t{\n\t\tuserId: { default: 0 },\n\t\tdialogId: { default: '0' },\n\t\tchatId: { default: 0 },\n\t\tmessageType: { default: MessageType.self },\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\tdefault: MessagesModel.create().getElementState\n\t\t},\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\tdefault: UsersModel.create().getElementState\n\t\t},\n\t\tdialog: {\n\t\t\ttype: Object,\n\t\t\tdefault: DialoguesModel.create().getElementState\n\t\t},\n\t\tfiles: {\n\t\t\ttype: Object,\n\t\t\tdefault: {}\n\t\t},\n\t\tenableReactions: { default: true },\n\t\tshowName: { default: true },\n\t\tshowAvatar: { default: true },\n\t\treferenceContentBodyClassName: { default: ''},\n\t\treferenceContentNameClassName: { default: ''},\n\t},\n\tcreated()\n\t{\n\t\tthis.dateFormatFunction = null;\n\t\tthis.cacheFormatDate = {};\n\t},\n\tmethods:\n\t{\n\t\tclickByUserName(event)\n\t\t{\n\t\t\tthis.$emit('clickByUserName', event)\n\t\t},\n\t\tclickByUploadCancel(event)\n\t\t{\n\t\t\tthis.$emit('clickByUploadCancel', event)\n\t\t},\n\t\tclickByKeyboardButton(event)\n\t\t{\n\t\t\tthis.$emit('clickByKeyboardButton', {message: event.message, ...event.event});\n\t\t},\n\t\tsetReaction(event)\n\t\t{\n\t\t\tthis.$emit('setReaction', event)\n\t\t},\n\t\topenReactionList(event)\n\t\t{\n\t\t\tthis.$emit('openReactionList', event)\n\t\t},\n\t\tformatDate(date)\n\t\t{\n\t\t\tconst id = date.toJSON().slice(0, 10);\n\n\t\t\tif (this.cacheFormatDate[id])\n\t\t\t{\n\t\t\t\treturn this.cacheFormatDate[id];\n\t\t\t}\n\n\t\t\tlet dateFormat = Utils.date.getFormatType(\n\t\t\t\tBX.Messenger.Const.DateFormat.message,\n\t\t\t\tthis.$root.$bitrixMessages\n\t\t\t);\n\n\t\t\tthis.cacheFormatDate[id] = this._getDateFormat().format(dateFormat, date);\n\n\t\t\treturn this.cacheFormatDate[id];\n\t\t},\n\t\t_getDateFormat()\n\t\t{\n\t\t\tif (this.dateFormatFunction)\n\t\t\t{\n\t\t\t\treturn this.dateFormatFunction;\n\t\t\t}\n\n\t\t\tthis.dateFormatFunction = Object.create(BX.Main.Date);\n\t\t\tif (this.$root.$bitrixMessages)\n\t\t\t{\n\t\t\t\tthis.dateFormatFunction._getMessage = (phrase) => this.$root.$bitrixMessages[phrase];\n\t\t\t}\n\n\t\t\treturn this.dateFormatFunction;\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tMessageType: () => MessageType,\n\t\tContentType: () => ContentType,\n\n\t\tcontentType()\n\t\t{\n\t\t\tif (this.filesData.length > 0)\n\t\t\t{\n\t\t\t\tlet onlyImage = false;\n\t\t\t\tlet onlyVideo = false;\n\t\t\t\tlet onlyAudio = false;\n\t\t\t\tlet inProgress = false;\n\n\t\t\t\tfor (let file of this.filesData)\n\t\t\t\t{\n\t\t\t\t\tif (file.progress < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tinProgress = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\telse if (file.type === 'audio')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (onlyVideo || onlyImage)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonlyImage = false;\n\t\t\t\t\t\t\tonlyVideo = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonlyAudio = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (file.type === 'image' && file.image)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (onlyVideo || onlyAudio)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonlyAudio = false;\n\t\t\t\t\t\t\tonlyVideo = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonlyImage = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (file.type === 'video')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (onlyImage || onlyAudio)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonlyAudio = false;\n\t\t\t\t\t\t\tonlyImage = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonlyVideo = true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tonlyAudio = false;\n\t\t\t\t\t\tonlyImage = false;\n\t\t\t\t\t\tonlyVideo = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (inProgress)\n\t\t\t\t{\n\t\t\t\t\treturn ContentType.progress;\n\t\t\t\t}\n\t\t\t\telse if (onlyImage)\n\t\t\t\t{\n\t\t\t\t\treturn ContentType.image;\n\t\t\t\t}\n\t\t\t\telse if (onlyAudio)\n\t\t\t\t{\n\t\t\t\t\treturn ContentType.audio;\n\t\t\t\t}\n\t\t\t\telse if (onlyVideo)\n\t\t\t\t{\n\t\t\t\t\treturn ContentType.video;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn ContentType.default;\n\t\t},\n\n\t\tlocalize()\n\t\t{\n\t\t\treturn Vue.getFilteredPhrases('IM_MESSENGER_MESSAGE_', this.$root.$bitrixMessages);\n\t\t},\n\n\t\tformattedDate()\n\t\t{\n\t\t\treturn this.formatDate(this.message.date);\n\t\t},\n\n\t\tmessageText()\n\t\t{\n\t\t\tif (this.isDeleted)\n\t\t\t{\n\t\t\t\treturn this.localize.IM_MESSENGER_MESSAGE_DELETED;\n\t\t\t}\n\n\t\t\treturn this.message.textConverted;\n\t\t},\n\n\t\tmessageAttach()\n\t\t{\n\t\t\treturn this.message.params.ATTACH;\n\t\t},\n\n\t\tmessageReactions()\n\t\t{\n\t\t\treturn this.message.params.REACTION || {};\n\t\t},\n\n\t\tisEdited()\n\t\t{\n\t\t\treturn this.message.params.IS_EDITED === 'Y';\n\t\t},\n\n\t\tisDeleted()\n\t\t{\n\t\t\treturn this.message.params.IS_DELETED === 'Y';\n\t\t},\n\n\t\tchatColor()\n\t\t{\n\t\t\treturn this.dialog.type !== DialogType.private? this.user.color:  this.dialog.color;\n\t\t},\n\n\t\tfilesData()\n\t\t{\n\t\t\tlet files = [];\n\n\t\t\tif (!this.message.params.FILE_ID || this.message.params.FILE_ID.length <= 0)\n\t\t\t{\n\t\t\t\treturn files;\n\t\t\t}\n\n\t\t\tthis.message.params.FILE_ID.forEach(fileId => {\n\t\t\t\tif (!fileId)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet file = this.$store.getters['files/get'](this.chatId, fileId, true);\n\t\t\t\tif (!file)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.commit('files/set', {data: [\n\t\t\t\t\t\tthis.$store.getters['files/getBlank']({id: fileId, chatId: this.chatId})\n\t\t\t\t\t]});\n\t\t\t\t\tfile = this.$store.getters['files/get'](this.chatId, fileId, true);\n\t\t\t\t}\n\t\t\t\tif (file)\n\t\t\t\t{\n\t\t\t\t\tfiles.push(file);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn files;\n\t\t},\n\n\t\tkeyboardButtons()\n\t\t{\n\t\t\tlet result = false;\n\n\t\t\tif (!this.message.params.KEYBOARD || this.message.params.KEYBOARD === 'N')\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\treturn this.message.params.KEYBOARD;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-message-content-wrap\">\n\t\t\t<template v-if=\"contentType == ContentType.default || contentType == ContentType.audio || contentType == ContentType.progress\">\n\t\t\t\t<div class=\"bx-im-message-content\">\n\t\t\t\t\t<span class=\"bx-im-message-content-box\">\n\t\t\t\t\t\t<template v-if=\"showName && messageType == MessageType.opponent\">\n\t\t\t\t\t\t\t<div :class=\"['bx-im-message-content-name', referenceContentNameClassName]\" :style=\"{color: user.color}\" @click=\"clickByUserName({user: user, event: $event})\">{{!showAvatar? user.name: (user.firstName? user.firstName: user.name)}}</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div :class=\"['bx-im-message-content-body', referenceContentBodyClassName]\">\n\t\t\t\t\t\t\t<template v-if=\"contentType == ContentType.audio\">\n\t\t\t\t\t\t\t\t<bx-messenger-element-file-audio v-for=\"file in filesData\" :messageType=\"messageType\" :file=\"file\" :key=\"file.templateId\" @uploadCancel=\"clickByUploadCancel\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<bx-messenger-element-file v-for=\"file in filesData\" :messageType=\"messageType\" :file=\"file\" :key=\"file.templateId\" @uploadCancel=\"clickByUploadCancel\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div :class=\"['bx-im-message-content-body-wrap', {\n\t\t\t\t\t\t\t\t'bx-im-message-content-body-with-text': messageText.length > 0,\n\t\t\t\t\t\t\t\t'bx-im-message-content-body-without-text': messageText.length <= 0,\n\t\t\t\t\t\t\t}]\">\n\t\t\t\t\t\t\t\t<template v-if=\"messageText\">\n\t\t\t\t\t\t\t\t\t<span class=\"bx-im-message-content-text\" v-html=\"messageText\"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-for=\"(config, id) in messageAttach\">\n\t\t\t\t\t\t\t\t\t<bx-messenger-element-attach :config=\"config\" :baseColor=\"user.color\" :key=\"id\"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span class=\"bx-im-message-content-params\">\n\t\t\t\t\t\t\t\t\t<span class=\"bx-im-message-content-date\">{{formattedDate}}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if=\"enableReactions && message.authorId\" class=\"bx-im-message-content-reaction\">\n\t\t\t\t\t\t<bx-reaction :values=\"messageReactions\" :userId=\"userId\" :openList=\"false\" @set=\"setReaction({message: message, reaction: $event})\" @list=\"openReactionList({message: message, values: $event.values})\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"contentType == ContentType.richLink\">\n\t\t\t\t<!-- richLink type markup -->\n\t\t\t</template>\n\t\t\t<template v-else-if=\"contentType == ContentType.image || contentType == ContentType.video\">\n\t\t\t\t<div class=\"bx-im-message-content bx-im-message-content-fit\">\n\t\t\t\t\t<span class=\"bx-im-message-content-box\">\n\t\t\t\t\t\t<template v-if=\"showName && messageType == MessageType.opponent\">\n\t\t\t\t\t\t\t<div :class=\"['bx-im-message-content-name', referenceContentNameClassName]\" :style=\"{color: user.color}\" @click=\"clickByUserName({user: user, event: $event})\">{{!showAvatar? user.name: (user.firstName? user.firstName: user.name)}}</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div :class=\"['bx-im-message-content-body', referenceContentBodyClassName]\">\n\t\t\t\t\t\t\t<template v-if=\"contentType == ContentType.image\">\n\t\t\t\t\t\t\t\t<bx-messenger-element-file-image v-for=\"file in filesData\" :messageType=\"messageType\" :file=\"file\" :key=\"file.templateId\" @uploadCancel=\"clickByUploadCancel\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else-if=\"contentType == ContentType.video\">\n\t\t\t\t\t\t\t\t<bx-messenger-element-file-video v-for=\"file in filesData\" :messageType=\"messageType\" :file=\"file\" :key=\"file.templateId\" @uploadCancel=\"clickByUploadCancel\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<div :class=\"['bx-im-message-content-body-wrap', {\n\t\t\t\t\t\t\t\t'bx-im-message-content-body-with-text': messageText.length > 0,\n\t\t\t\t\t\t\t\t'bx-im-message-content-body-without-text': messageText.length <= 0,\n\t\t\t\t\t\t\t}]\">\n\t\t\t\t\t\t\t\t<template v-if=\"messageText\">\n\t\t\t\t\t\t\t\t\t<span class=\"bx-im-message-content-text\" v-html=\"messageText\"></span>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<span class=\"bx-im-message-content-params\">\n\t\t\t\t\t\t\t\t\t<span class=\"bx-im-message-content-date\">{{formattedDate}}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div v-if=\"enableReactions && message.authorId\" class=\"bx-im-message-content-reaction\">\n\t\t\t\t\t\t<bx-reaction :values=\"messageReactions\" :userId=\"userId\" :openList=\"false\" @set=\"setReaction({message: message, reaction: $event})\" @list=\"openReactionList({message: message, values: $event.values})\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"keyboardButtons\">\n\t\t\t\t<bx-messenger-element-keyboard :buttons=\"keyboardButtons\" :messageId=\"message.id\" :userId=\"userId\" :dialogId=\"dialogId\" @click=\"clickByKeyboardButton({message: message, event: $event})\"/>\n\t\t\t</template>\n\t\t</div>\n\t`\n});"],"names":["BX","window","ContentType","Object","freeze","default","progress","image","audio","video","richLink","Vue","component","props","userId","dialogId","chatId","messageType","MessageType","self","message","type","MessagesModel","create","getElementState","user","UsersModel","dialog","DialoguesModel","files","enableReactions","showName","showAvatar","referenceContentBodyClassName","referenceContentNameClassName","created","dateFormatFunction","cacheFormatDate","methods","clickByUserName","event","$emit","clickByUploadCancel","clickByKeyboardButton","setReaction","openReactionList","formatDate","date","id","toJSON","slice","dateFormat","Utils","getFormatType","Messenger","Const","DateFormat","$root","$bitrixMessages","_getDateFormat","format","Main","Date","_getMessage","phrase","computed","contentType","filesData","length","onlyImage","onlyVideo","onlyAudio","inProgress","file","localize","getFilteredPhrases","formattedDate","messageText","isDeleted","IM_MESSENGER_MESSAGE_DELETED","textConverted","messageAttach","params","ATTACH","messageReactions","REACTION","isEdited","IS_EDITED","IS_DELETED","chatColor","DialogType","private","color","FILE_ID","forEach","fileId","$store","getters","commit","data","push","keyboardButtons","result","KEYBOARD","template"],"mappings":"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"}