{"version":3,"file":"message.bundle.js","sources":["../src/message.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Message Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './message.css';\nimport 'im.component.message.body';\n\nimport {DialoguesModel, MessagesModel} from 'im.model';\nimport {Vue} from \"ui.vue\";\nimport {MessageType} from \"im.const\";\nimport {Utils} from \"im.utils\";\nimport {Animation} from \"im.tools.animation\";\n\nVue.component('bx-messenger-message',\n{\n\t/**\n\t * @emits 'clickByUserName' {user: object, event: MouseEvent}\n\t * @emits 'clickByUploadCancel' {file: object, event: MouseEvent}\n\t * @emits 'clickByKeyboardButton' {message: object, action: string, params: Object}\n\t * @emits 'clickByMessageMenu' {message: object, event: MouseEvent}\n\t * @emits 'clickByMessageRetry' {message: object, event: MouseEvent}\n\t * @emits 'setMessageReaction' {message: object, reaction: object}\n\t * @emits 'openMessageReactionList' {message: object, values: object}\n\t * @emits 'dragMessage' {result: boolean, event: MouseEvent}\n\t * @emits 'quoteMessage' {message: object}\n\t */\n\tprops:\n\t{\n\t\tuserId: { default: 0 },\n\t\tdialogId: { default: 0 },\n\t\tchatId: { default: 0 },\n\t\tenableReactions: { default: true },\n\t\tenableDateActions: { default: true },\n\t\tenableCreateContent: { default: true },\n\t\tenableGestureQuote: { default: true },\n\t\tenableGestureMenu: { default: false },\n\t\tshowAvatar: { default: true },\n\t\tshowMenu: { default: true },\n\t\tshowName: { default: true },\n\t\tshowLargeFont: { default: true },\n\t\tcapturedMoveEvent: { default: null },\n\t\treferenceContentClassName: { default: ''},\n\t\treferenceContentBodyClassName: { default: ''},\n\t\treferenceContentNameClassName: { default: ''},\n\t\tdialog: {\n\t\t\ttype: Object,\n\t\t\tdefault: DialoguesModel.create().getElementState\n\t\t},\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\tdefault: MessagesModel.create().getElementState\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tcomponentBodyId: 'bx-messenger-message-body',\n\t\t\tdrag: false,\n\t\t\tdragWidth: 0,\n\t\t\tdragPosition: 0,\n\t\t\tdragIconShow: false,\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tthis.dragStartPositionX = 0;\n\t\tthis.dragStartPositionY = 0;\n\t\tthis.dragMovePositionX = 0;\n\t\tthis.dragMovePositionY = 0;\n\t},\n\tbeforeDestroy()\n\t{\n\t\tclearTimeout(this.dragStartTimeout1);\n\t\tclearTimeout(this.dragStartTimeout2);\n\n\t\tif (this.dragBackAnimation)\n\t\t{\n\t\t\tAnimation.cancel(this.dragBackAnimation);\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tclickByAvatar(event)\n\t\t{\n\t\t\tthis.$emit('clickByUserName', event)\n\t\t},\n\t\tclickByUserName(event)\n\t\t{\n\t\t\tif (this.showAvatar && Utils.platform.isMobile())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$emit('clickByUserName', event)\n\t\t},\n\t\tclickByUploadCancel(event)\n\t\t{\n\t\t\tthis.$emit('clickByUploadCancel', event)\n\t\t},\n\t\tclickByKeyboardButton(event)\n\t\t{\n\t\t\tthis.$emit('clickByKeyboardButton', event)\n\t\t},\n\t\tclickByMessageMenu(event)\n\t\t{\n\t\t\tthis.$emit('clickByMessageMenu', event)\n\t\t},\n\t\tclickByMessageRetry(event)\n\t\t{\n\t\t\tthis.$emit('clickByMessageRetry', event)\n\t\t},\n\t\tsetMessageReaction(event)\n\t\t{\n\t\t\tthis.$emit('setMessageReaction', event)\n\t\t},\n\t\topenMessageReactionList(event)\n\t\t{\n\t\t\tthis.$emit('openMessageReactionList', event)\n\t\t},\n\t\tgestureRouter(eventName, event)\n\t\t{\n\t\t\tthis.gestureQuote(eventName, event);\n\t\t\tthis.gestureMenu(eventName, event);\n\t\t},\n\t\tgestureMenu(eventName, event)\n\t\t{\n\t\t\tif (!this.enableGestureMenu)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (eventName === 'touchstart')\n\t\t\t{\n\t\t\t\tthis.gestureMenuStarted = true;\n\t\t\t\tthis.gestureMenuPreventTouchEnd = false;\n\t\t\t\tif (event.target.tagName === \"A\")\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.gestureMenuStartPosition = {\n\t\t\t\t\tx: event.changedTouches[0].clientX,\n\t\t\t\t\ty: event.changedTouches[0].clientY\n\t\t\t\t};\n\n\t\t\t\tthis.gestureMenuTimeout = setTimeout(() => {\n\t\t\t\t\tthis.gestureMenuPreventTouchEnd = true;\n\t\t\t\t\tthis.$emit('clickByMessageMenu', {message: this.message, event});\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t\telse if (eventName === 'touchmove')\n\t\t\t{\n\t\t\t\tif (!this.gestureMenuStarted)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tMath.abs(this.gestureMenuStartPosition.x - event.changedTouches[0].clientX) >= 10\n\t\t\t\t\t|| Math.abs(this.gestureMenuStartPosition.y - event.changedTouches[0].clientY) >= 10\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.gestureMenuStarted = false;\n\t\t\t\t\tclearTimeout(this.gestureMenuTimeout);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (eventName === 'touchend')\n\t\t\t{\n\t\t\t\tif (!this.gestureMenuStarted)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.gestureMenuStarted = false;\n\t\t\t\tclearTimeout(this.gestureMenuTimeout);\n\t\t\t\tif (this.gestureMenuPreventTouchEnd)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgestureQuote(eventName, event)\n\t\t{\n\t\t\tif (!this.enableGestureQuote || Utils.platform.isAndroid())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst layerX = event.target.getBoundingClientRect().left + event.layerX;\n\t\t\tconst layerY = event.target.getBoundingClientRect().top + event.layerY;\n\n\t\t\tif (eventName === 'touchstart')\n\t\t\t{\n\t\t\t\tthis.dragCheck = true;\n\n\t\t\t\tthis.dragStartPositionX = layerX;\n\t\t\t\tthis.dragStartPositionY = layerY;\n\t\t\t\tthis.dragMovePositionX = null;\n\t\t\t\tthis.dragMovePositionY = null;\n\n\t\t\t\tclearTimeout(this.dragStartTimeout1);\n\t\t\t\tclearTimeout(this.dragStartTimeout2);\n\t\t\t\tthis.dragStartTimeout1 = setTimeout(() => {\n\t\t\t\t\tif (this.dragMovePositionX !== null && Math.abs(this.dragStartPositionY - this.dragMovePositionY) >= 10)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dragCheck = false;\n\t\t\t\t\t}\n\t\t\t\t}, 29);\n\n\t\t\t\tthis.dragStartTimeout2 = setTimeout(() => {\n\t\t\t\t\tthis.dragCheck = false;\n\n\t\t\t\t\tif (Math.abs(this.dragStartPositionY - this.dragMovePositionY) >= 10)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.dragMovePositionX === null)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.dragStartPositionX - this.dragMovePositionX < 9)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tAnimation.cancel(this.dragBackAnimation);\n\n\t\t\t\t\tthis.drag = true;\n\n\t\t\t\t\tthis.$emit('dragMessage', {result: this.drag, event});\n\t\t\t\t\tthis.dragWidth = this.$refs.body.offsetWidth;\n\n\t\t\t\t}, 80);\n\t\t\t}\n\t\t\telse if (eventName === 'touchmove')\n\t\t\t{\n\t\t\t\tif (this.drag || !this.dragCheck)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.dragMovePositionX = layerX;\n\t\t\t\tthis.dragMovePositionY = layerY;\n\t\t\t}\n\t\t\telse if (eventName === 'touchend')\n\t\t\t{\n\t\t\t\tclearTimeout(this.dragStartTimeout1);\n\t\t\t\tclearTimeout(this.dragStartTimeout2);\n\t\t\t\tthis.dragCheck = false;\n\t\t\t\tthis.dragIconShow = false;\n\n\t\t\t\tif (!this.drag)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tAnimation.cancel(this.dragBackAnimation);\n\n\t\t\t\tthis.drag = false;\n\t\t\t\tthis.$emit('dragMessage', {result: this.drag, event});\n\n\t\t\t\tif (this.dragPosition !== 0)\n\t\t\t\t{\n\t\t\t\t\tthis.$emit('quoteMessage', {message: this.message});\n\t\t\t\t}\n\n\t\t\t\tthis.dragBackAnimation = Animation.start({\n\t\t\t\t\tstart: this.dragPosition,\n\t\t\t\t\tend: 0,\n\t\t\t\t\tincrement: 20,\n\t\t\t\t\tduration:  300,\n\n\t\t\t\t\telement: this,\n\t\t\t\t\telementProperty: 'dragPosition',\n\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tthis.dragLayerPosition = undefined;\n\t\t\t\t\t\tthis.dragWidth = 0;\n\t\t\t\t\t\tthis.dragPosition = 0;\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tcapturedMoveEvent(event)\n\t\t{\n\t\t\tif (!this.drag || !event)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst layerX = event.target.getBoundingClientRect().left + event.layerX;\n\n\t\t\tif (typeof this.dragLayerPosition === 'undefined')\n\t\t\t{\n\t\t\t\tthis.dragLayerPosition = layerX;\n\t\t\t}\n\n\t\t\tconst movementX = this.dragLayerPosition - layerX;\n\n\t\t\tthis.dragLayerPosition = layerX;\n\n\t\t\tthis.dragPosition = this.dragPosition - movementX;\n\n\t\t\tconst dragPositionMax = (this.showAvatar? 30: 0) + 45;\n\t\t\tconst dragPositionIcon = (this.showAvatar? 20: 10);\n\n\t\t\tif (this.dragPosition < -dragPositionMax)\n\t\t\t{\n\t\t\t\tthis.dragPosition = -dragPositionMax;\n\t\t\t}\n\t\t\telse if (this.dragPosition < -dragPositionIcon)\n\t\t\t{\n\t\t\t\tif (!this.dragIconShow)\n\t\t\t\t{\n\t\t\t\t\tthis.dragIconShow = true;\n\n\t\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout(() => app.exec(\"callVibration\"), 200);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.dragPosition > 0)\n\t\t\t{\n\t\t\t\tthis.dragPosition = 0;\n\t\t\t}\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tMessageType: () => MessageType,\n\n\t\ttype()\n\t\t{\n\t\t\tif (this.message.system || this.message.authorId == 0)\n\t\t\t{\n\t\t\t\treturn MessageType.system;\n\t\t\t}\n\t\t\telse if (this.message.authorId === -1 || this.message.authorId == this.userId)\n\t\t\t{\n\t\t\t\treturn MessageType.self;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn MessageType.opponent;\n\t\t\t}\n\t\t},\n\n\t\tlocalize()\n\t\t{\n\t\t\tlet localize = Vue.getFilteredPhrases('IM_MESSENGER_MESSAGE_', this.$root.$bitrixMessages);\n\n\t\t\treturn Object.freeze(\n\t\t\t\tObject.assign({}, localize, {\n\t\t\t\t\t'IM_MESSENGER_MESSAGE_MENU_TITLE': localize.IM_MESSENGER_MESSAGE_MENU_TITLE.replace('#SHORTCUT#', Utils.platform.isMac()? 'CMD':'CTRL')\n\t\t\t\t})\n\t\t\t);\n\t\t},\n\n\t\tuserData()\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.message.authorId, true);\n\t\t},\n\n\t\tuserAvatar()\n\t\t{\n\t\t\treturn this.userData.avatar? `url('${this.userData.avatar}')`: ''\n\t\t},\n\n\t\tfilesData()\n\t\t{\n\t\t\tlet files = this.$store.getters['files/getList'](this.chatId);\n\t\t\treturn files? files: {};\n\t\t},\n\n\t\tisEdited()\n\t\t{\n\t\t\treturn this.message.params.IS_EDITED === 'Y';\n\t\t},\n\n\t\tisDeleted()\n\t\t{\n\t\t\treturn this.message.params.IS_DELETED === 'Y';\n\t\t},\n\n\t\tisLargeFont()\n\t\t{\n\t\t\treturn this.showLargeFont && this.message.params.LARGE_FONT === 'Y';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"['bx-im-message', {\n\t\t\t\t'bx-im-message-without-menu': !showMenu,\n\t\t\t\t'bx-im-message-without-avatar': !showAvatar,\n\t\t\t\t'bx-im-message-type-system': type === MessageType.system,\n\t\t\t\t'bx-im-message-type-self': type === MessageType.self,\n\t\t\t\t'bx-im-message-type-other': type !== MessageType.self,\n\t\t\t\t'bx-im-message-type-opponent': type === MessageType.opponent,\n\t\t\t\t'bx-im-message-status-error': message.error,\n\t\t\t\t'bx-im-message-status-unread': message.unread,\n\t\t\t\t'bx-im-message-status-blink': message.blink,\n\t\t\t\t'bx-im-message-status-edited': isEdited,\n\t\t\t\t'bx-im-message-status-deleted': isDeleted,\n\t\t\t\t'bx-im-message-large-font': isLargeFont,\n\t\t\t}]\" \n\t\t\t@touchstart=\"gestureRouter('touchstart', $event)\"\n\t\t\t@touchmove=\"gestureRouter('touchmove', $event)\"\n\t\t\t@touchend=\"gestureRouter('touchend', $event)\"\n\t\t\tref=\"body\"\n\t\t\t:style=\"{\n\t\t\t\twidth: dragWidth > 0? dragWidth+'px': '', \n\t\t\t\tmarginLeft: dragPosition < 0? dragPosition+'px': '', \n\t\t\t}\"\n\t\t>\n\t\t\t<template v-if=\"type === MessageType.self\">\n\t\t\t\t<template v-if=\"dragIconShow\">\n\t\t\t\t\t<div class=\"bx-im-message-reply\">\n\t\t\t\t\t\t<div class=\"bx-im-message-reply-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t\t<div class=\"bx-im-message-box\">\n\t\t\t\t\t<component :is=\"componentBodyId\"\n\t\t\t\t\t\t:userId=\"userId\" \n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t\t:messageType=\"type\"\n\t\t\t\t\t\t:dialog=\"dialog\"\n\t\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t\t:user=\"userData\"\n\t\t\t\t\t\t:files=\"filesData\"\n\t\t\t\t\t\t:showAvatar=\"showAvatar\"\n\t\t\t\t\t\t:showName=\"showName\"\n\t\t\t\t\t\t:enableReactions=\"enableReactions\"\n\t\t\t\t\t\t:referenceContentBodyClassName=\"referenceContentBodyClassName\"\n\t\t\t\t\t\t:referenceContentNameClassName=\"referenceContentNameClassName\"\n\t\t\t\t\t\t@clickByUserName=\"clickByUserName\"\n\t\t\t\t\t\t@clickByUploadCancel=\"clickByUploadCancel\"\n\t\t\t\t\t\t@clickByKeyboardButton=\"clickByKeyboardButton\"\n\t\t\t\t\t\t@setReaction=\"setMessageReaction\"\n\t\t\t\t\t\t@openReactionList=\"openMessageReactionList\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-message-box-status\">\n\t\t\t\t\t<transition name=\"bx-im-message-sending\">\n\t\t\t\t\t\t<template v-if=\"message.sending\">\n\t\t\t\t\t\t\t<div class=\"bx-im-message-sending\"></div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</transition>\n\t\t\t\t\t<transition name=\"bx-im-message-status-retry\">\n\t\t\t\t\t\t<template v-if=\"!message.sending && message.error && message.retry\">\n\t\t\t\t\t\t\t<div class=\"bx-im-message-status-retry\" :title=\"localize.IM_MESSENGER_MESSAGE_RETRY_TITLE\" @click=\"clickByMessageRetry({message: message, event: $event})\">\n\t\t\t\t\t\t\t\t<span class=\"bx-im-message-retry-icon\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</transition>\n\t\t\t\t\t<template v-if=\"showMenu && !message.sending && !message.error\">\n\t\t\t\t\t\t<div class=\"bx-im-message-status-menu\" :title=\"localize.IM_MESSENGER_MESSAGE_MENU_TITLE\" @click=\"clickByMessageMenu({message: message, event: $event})\">\n\t\t\t\t\t\t\t<span class=\"bx-im-message-menu-icon\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template> \n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"type !== MessageType.self\">\n\t\t\t\t<template v-if=\"type === MessageType.opponent\">\n\t\t\t\t\t<div v-if=\"showAvatar\" class=\"bx-im-message-avatar\" @click=\"clickByAvatar({user: userData, event: $event})\">\n\t\t\t\t\t\t<div :class=\"['bx-im-message-avatar-image', {\n\t\t\t\t\t\t\t\t'bx-im-message-avatar-image-default': !userData.avatar\n\t\t\t\t\t\t\t}]\"\n\t\t\t\t\t\t\t:style=\"{\n\t\t\t\t\t\t\t\tbackgroundColor: !userData.avatar? userData.color: '', \n\t\t\t\t\t\t\t\tbackgroundImage: userAvatar\n\t\t\t\t\t\t\t}\" \n\t\t\t\t\t\t\t:title=\"userData.name\"\n\t\t\t\t\t\t></div>\t\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div class=\"bx-im-message-box\">\n\t\t\t\t\t<component :is=\"componentBodyId\"\n\t\t\t\t\t\t:userId=\"userId\" \n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:chatId=\"chatId\"\n\t\t\t\t\t\t:messageType=\"type\"\n\t\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t\t:user=\"userData\"\n\t\t\t\t\t\t:files=\"filesData\"\n\t\t\t\t\t\t:showAvatar=\"showAvatar\"\n\t\t\t\t\t\t:showName=\"showName\"\n\t\t\t\t\t\t:enableReactions=\"enableReactions\"\n\t\t\t\t\t\t:referenceContentBodyClassName=\"referenceContentBodyClassName\"\n\t\t\t\t\t\t:referenceContentNameClassName=\"referenceContentNameClassName\"\n\t\t\t\t\t\t@clickByUserName=\"clickByUserName\"\n\t\t\t\t\t\t@clickByUploadCancel=\"clickByUploadCancel\"\n\t\t\t\t\t\t@clickByKeyboardButton=\"clickByKeyboardButton\"\n\t\t\t\t\t\t@setReaction=\"setMessageReaction\"\n\t\t\t\t\t\t@openReactionList=\"openMessageReactionList\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showMenu\"  class=\"bx-im-message-menu\" :title=\"localize.IM_MESSENGER_MESSAGE_MENU_TITLE\" @click=\"clickByMessageMenu({message: message, event: $event})\">\n\t\t\t\t\t<span class=\"bx-im-message-menu-icon\"></span>\n\t\t\t\t</div>\t\n\t\t\t\t<template v-if=\"dragIconShow\">\n\t\t\t\t\t<div class=\"bx-im-message-reply\">\n\t\t\t\t\t\t<div class=\"bx-im-message-reply-icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template> \n\t\t\t</template>\n\t\t</div>\n\t`\n});"],"names":["Vue","component","props","userId","default","dialogId","chatId","enableReactions","enableDateActions","enableCreateContent","enableGestureQuote","enableGestureMenu","showAvatar","showMenu","showName","showLargeFont","capturedMoveEvent","referenceContentClassName","referenceContentBodyClassName","referenceContentNameClassName","dialog","type","Object","DialoguesModel","create","getElementState","message","MessagesModel","data","componentBodyId","drag","dragWidth","dragPosition","dragIconShow","created","dragStartPositionX","dragStartPositionY","dragMovePositionX","dragMovePositionY","beforeDestroy","clearTimeout","dragStartTimeout1","dragStartTimeout2","dragBackAnimation","Animation","cancel","methods","clickByAvatar","event","$emit","clickByUserName","Utils","platform","isMobile","clickByUploadCancel","clickByKeyboardButton","clickByMessageMenu","clickByMessageRetry","setMessageReaction","openMessageReactionList","gestureRouter","eventName","gestureQuote","gestureMenu","gestureMenuStarted","gestureMenuPreventTouchEnd","target","tagName","gestureMenuStartPosition","x","changedTouches","clientX","y","clientY","gestureMenuTimeout","setTimeout","Math","abs","preventDefault","isAndroid","layerX","getBoundingClientRect","left","layerY","top","dragCheck","result","$refs","body","offsetWidth","start","end","increment","duration","element","elementProperty","callback","dragLayerPosition","undefined","watch","movementX","dragPositionMax","dragPositionIcon","isBitrixMobile","app","exec","computed","MessageType","system","authorId","self","opponent","localize","getFilteredPhrases","$root","$bitrixMessages","freeze","assign","IM_MESSENGER_MESSAGE_MENU_TITLE","replace","isMac","userData","$store","getters","userAvatar","avatar","filesData","files","isEdited","params","IS_EDITED","isDeleted","IS_DELETED","isLargeFont","LARGE_FONT","template"],"mappings":"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"}