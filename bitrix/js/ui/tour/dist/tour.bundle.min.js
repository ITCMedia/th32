this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(t,e){"use strict";var n=function(t){babelHelpers.inherits(n,t);function n(t){var i;babelHelpers.classCallCheck(this,n);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).call(this,t));i.target=null;if(e.Type.isString(t.target)&&t.target!==""||e.Type.isFunction(t.target)||e.Type.isDomNode(t.target)){i.target=t.target}i.id=t.id||null;i.text=t.text;i.areaPadding=t.areaPadding;i.link=t.link||"";i.rounded=t.rounded||false;i.title=t.title||null;i.article=t.article||null;i.position=t.position||null;var r=e.Type.isPlainObject(t.events)?t.events:{};var u=function t(n){var u=e.Type.isFunction(r[n])?r[n]:e.Reflection.getClass(r[n]);if(u){i.subscribe(i.getFullEventName(n),function(){u()})}};for(var s in r){u(s)}return i}babelHelpers.createClass(n,[{key:"getTarget",value:function t(){if(e.Type.isString(this.target)&&this.target!==""){return document.querySelector(this.target)}if(e.Type.isFunction(this.target)){return this.target()}return this.target}},{key:"getId",value:function t(){return this.id}},{key:"getAreaPadding",value:function t(){return this.areaPadding}},{key:"getRounded",value:function t(){return this.rounded}},{key:"getText",value:function t(){return this.text}},{key:"getLink",value:function t(){return this.link}},{key:"getTitle",value:function t(){return this.title}},{key:"getPosition",value:function t(){return this.position}},{key:"getArticle",value:function t(){return this.article}},{key:"getFullEventName",value:function t(e){return"Step:"+e}},{key:"setTarget",value:function t(e){this.target=e}}]);return n}(e.Event.EventEmitter);function i(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<button class="ui-btn ui-btn-sm ui-btn-primary ui-btn-round" onclick="','">\n\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t"]);i=function e(){return t};return t}function r(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<button class="','" onclick="','">\n\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t"]);r=function e(){return t};return t}function u(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-tour-popup">\n\t\t\t\t\t<div class="ui-tour-popup-title">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-tour-popup-content">\n\t\t\t\t\t\t<div class="ui-tour-popup-text">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-tour-popup-footer-btn">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"]);u=function e(){return t};return t}function s(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="ui-tour-popup-index-item">\n\t\t\t\t</span>\n\t\t\t']);s=function e(){return t};return t}function o(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="ui-tour-popup-index-items">\n\t\t\t\t</span>\n\t\t\t']);o=function e(){return t};return t}function l(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<button id="back" class="ui-tour-popup-btn-back">\n\t\t\t\t</button>\n\t\t\t']);l=function e(){return t};return t}function a(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<button id="next" class="ui-tour-popup-btn-next">\n\t\t\t\t\t',"\n\t\t\t\t</button>\n\t\t\t"]);a=function e(){return t};return t}function h(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-tour-popup-btn-block"></div>\n\t\t\t']);h=function e(){return t};return t}function p(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="ui-tour-popup-counter">\n\t\t\t\t\t',"\n\t\t\t\t</span>\n\t\t\t"]);p=function e(){return t};return t}function c(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<a target="_blank" href="" class="ui-tour-popup-link">\n\t\t\t\t\t',"\n\t\t\t\t</a>\n\t\t\t"]);c=function e(){return t};return t}function g(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-tour-popup-text"></div>\n\t\t\t']);g=function e(){return t};return t}function d(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-tour-popup-title"></div>\n\t\t\t']);d=function e(){return t};return t}function f(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-tour-popup">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="ui-tour-popup-content">\n\t\t\t\t\t\t',"\n\t\t\t\t\t\t",'\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-tour-popup-footer">\n\t\t\t\t\t\t<div class="ui-tour-popup-index">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t","\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"]);f=function e(){return t};return t}function y(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<svg class="ui-tour-overlay" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" preserveAspectRatio="none">\n\t\t\t\t<mask id="hole">\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<filter id="ui-tour-filter">\n\t\t\t\t\t\t\t<feGaussianBlur stdDeviation="0"/>\n\t\t\t\t\t\t</filter>\n\t\t\t\t\t</defs>\n\t\t\t\t\t<rect x="0" y="0" width="100%" height="100%" fill="white"></rect>\n\t\t\t\t\t<rect id="rect" class="ui-tour-overlay-element ui-tour-overlay-element-rect" x="1035.5" y="338" width="422" rx="2" ry="2" height="58" filter="url(#ui-tour-filter)"></rect>\n\t\t\t\t\t<circle id="circle" class="ui-tour-overlay-element ui-tour-overlay-element-circle" cx="10" cy="10" r="10" filter="url(#ui-tour-filter)"></circle>\n\t\t\t\t</mask>\n\t\t\t\t<rect x="0" y="0" width="100%" height="100%" fill="#000" mask="url(#hole)"></rect>\n\t\t\t</svg>\n\t\t']);y=function e(){return t};return t}var v=function(t){babelHelpers.inherits(v,t);function v(){var t;var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,v);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(v).call(this,i));i=e.Type.isPlainObject(i)?i:{};t.steps=[];if(Array.isArray(i.steps)){i.steps.forEach(function(e){t.steps.push(new n(e))})}if(t.steps.length<1){throw new Error("BX.UI.Tour.Guide: 'steps' argument is required.")}t.id="ui-tour-guide-"+e.Text.getRandom();t.setId(i.id);t.autoSave=false;t.popup=null;t.layout={overlay:null,element:null,title:null,text:null,link:null,btnContainer:null,nextBtn:null,backBtn:null,content:null,finalContent:null,counter:null,currentCounter:null,counterItems:[]};t.buttons=i.buttons||"";t.currentStepIndex=0;t.targetPos=null;t.clickOnBackBtn=false;t.finalStep=i.finalStep||false;t.finalText=i.finalText||"";t.finalTitle=i.finalTitle||"";t.setAutoSave(i.autoSave);var r=e.Type.isPlainObject(i.events)?i.events:{};var u=function n(i){var u=e.Type.isFunction(r[i])?r[i]:e.Reflection.getClass(r[i]);if(u){t.subscribe(t.getFullEventName(i),function(){u()})}};for(var s in r){u(s)}e.Event.bind(window,"resize",t.handleResizeWindow.bind(babelHelpers.assertThisInitialized(t)));return t}babelHelpers.createClass(v,[{key:"getId",value:function t(){return this.id}},{key:"setId",value:function t(n){if(e.Type.isString(n)&&n!==""){this.id=n}}},{key:"getAutoSave",value:function t(){return this.autoSave}},{key:"setAutoSave",value:function t(n){if(e.Type.isBoolean(n)){this.autoSave=n}}},{key:"save",value:function t(){var n="view_date_"+this.getId();e.userOptions.save("ui-tour",n,null,Math.floor(Date.now()/1e3));e.userOptions.send(null)}},{key:"start",value:function t(){this.emit(this.getFullEventName("onStart"),{guide:this});if(this.getAutoSave()){this.save()}this.setOverlay();var n=this.getPopup();n.show();if(this.popup.getPopupContainer()){e.Dom.removeClass(this.popup.getPopupContainer(),"popup-window-ui-tour-opacity")}this.showStep();e.Dom.addClass(this.layout.backBtn,"ui-tour-popup-btn-disabled");if(this.getCurrentStep().getTarget()){e.Dom.addClass(this.getCurrentStep().getTarget(),"ui-tour-selector")}}},{key:"close",value:function t(){this.emit(this.getFullEventName("onFinish"),{guide:this});this.getPopup().destroy();e.Dom.remove(this.layout.overlay);e.Dom.removeClass(document.body,"ui-tour-body-overflow");if(this.getCurrentStep()){this.getCurrentStep().getTarget().classList.remove("ui-tour-selector")}this.layout.overlay=null;this.layout.element=null;this.layout.title=null;this.layout.text=null;this.layout.link=null;this.layout.btnContainer=null;this.layout.nextBtn=null;this.layout.backBtn=null;this.layout.content=null;this.layout.finalContent=null;this.layout.counter=null;this.layout.currentCounter=null;this.layout.counterItems=[]}},{key:"showStep",value:function t(){this.getCurrentStep().emit(this.getCurrentStep().getFullEventName("onShow"),{step:this.getCurrentStep(),guide:this});if(!this.getCurrentStep().getTarget()){throw new Error("BX.UI.Tour.Guide: 'target' argument is undefined.")}var n=this.getCurrentStep().getTarget().getBoundingClientRect();if(!this.isTargetVisible(n)){this.scrollToTarget(n)}e.Dom.removeClass(this.popup.getPopupContainer(),"popup-window-ui-tour-opacity");if(this.layout.element){e.Dom.removeClass(this.layout.element,"ui-tour-overlay-element-opacity")}setTimeout(function(){this.layout.backBtn.style.display="block"}.bind(this),10);this.setOverlayElementForm();this.setCoords(this.getCurrentStep().getTarget());this.setPopupData()}},{key:"closeStep",value:function t(){this.getCurrentStep().emit(this.getCurrentStep().getFullEventName("onClose"),{step:this.getCurrentStep(),guide:this});if(this.getCurrentStep().getTarget()){e.Dom.removeClass(this.getCurrentStep().getTarget(),"ui-tour-selector")}}},{key:"setPopupPosition",value:function t(){if(!this.getCurrentStep().getTarget()||this.targetPos===null){this.getPopup().setBindElement(null);this.getPopup().setOffset({offsetLeft:0,offsetTop:0});this.getPopup().setAngle(false);this.getPopup().adjustPosition();return}var e=0;var n=-15;var i=0;var r="top";var u={forceTop:true,forceLeft:true,forceBindPosition:true};var s=this.getPopup().getPopupContainer().offsetWidth;var o=document.documentElement.clientWidth;if(this.getCurrentStep().getPosition()==="right"){r="left";e=this.targetPos.width+30;n=this.targetPos.height+this.getAreaPadding();if(this.targetPos.left+e+s>o){var l=this.targetPos.left-s;if(l>0){e=-s-30;r="right"}}}else if(this.getCurrentStep().getPosition()==="left"){r="right";e=-this.targetPos.width-(s-this.targetPos.width)-40;n=this.targetPos.height+this.getAreaPadding();if(this.targetPos.right+e+s<o){var a=this.targetPos.left-s;if(a<0){e=this.targetPos.width+40;r="left"}}}else{u.forceLeft=false;u.forceTop=false;if(this.getCurrentStep().getRounded()){n=-(this.layout.element.getAttribute("r")-this.targetPos.height/2+10);i=0;e=this.targetPos.width/2}else if(this.targetPos.width<30){e=this.targetPos.width/2;n=-15;i=0}else{e=25;n=-(this.layout.element.getAttribute("height")/2-this.targetPos.height/2+10);i=0}}this.getPopup().setBindElement(this.getCurrentStep().getTarget());this.getPopup().setOffset({offsetLeft:e,offsetTop:-n});this.getPopup().setAngle({position:r,offset:i});this.getPopup().adjustPosition(u)}},{key:"setOverlay",value:function t(){this.layout.overlay=e.Tag.render(y());e.Dom.addClass(document.body,"ui-tour-body-overflow");e.Dom.append(this.layout.overlay,document.body);this.setOverlayElementForm()}},{key:"setOverlayElementForm",value:function t(){if(this.getCurrentStep().getRounded()){this.layout.overlay.querySelector(".ui-tour-overlay-element-rect").style.display="none";this.layout.overlay.querySelector(".ui-tour-overlay-element-circle").style.display="block";this.layout.element=this.layout.overlay.querySelector(".ui-tour-overlay-element-circle")}else{this.layout.overlay.querySelector(".ui-tour-overlay-element-circle").style.display="none";this.layout.overlay.querySelector(".ui-tour-overlay-element-rect").style.display="block";this.layout.element=this.layout.overlay.querySelector(".ui-tour-overlay-element-rect")}return this.layout.element}},{key:"handleResizeWindow",value:function t(){if(this.layout.element){this.setCoords(this.getCurrentStep().getTarget())}}},{key:"setCoords",value:function t(e){if(!e){this.layout.element.style.display="none";return}this.layout.element.style.display="block";this.targetPos=e.getBoundingClientRect();if(this.getCurrentStep().getRounded()){this.layout.element.setAttribute("cx",this.targetPos.left+this.targetPos.width/2);this.layout.element.setAttribute("cy",this.targetPos.top+this.targetPos.height/2);this.layout.element.setAttribute("r",this.targetPos.width/2+this.getAreaPadding())}else{this.layout.element.setAttribute("x",this.targetPos.left-this.getAreaPadding());this.layout.element.setAttribute("y",this.targetPos.top-this.getAreaPadding());this.layout.element.setAttribute("width",this.targetPos.width+this.getAreaPadding()*2);this.layout.element.setAttribute("height",this.targetPos.height+this.getAreaPadding()*2)}}},{key:"getAreaPadding",value:function t(){var e=15;if(this.getCurrentStep().getAreaPadding()>=0){e=this.getCurrentStep().getAreaPadding()}return e}},{key:"increaseCurrentStepIndex",value:function t(){this.currentStepIndex++;if(this.currentStepIndex+1===this.steps.length&&!this.finalStep){setTimeout(function(){this.layout.nextBtn.textContent=e.Loc.getMessage("JS_UI_TOUR_BUTTON_CLOSE")}.bind(this),200)}}},{key:"reduceCurrentStepIndex",value:function t(){if(this.currentStepIndex===0){return}if(this.currentStepIndex<this.steps.length&&!this.finalStep){this.layout.nextBtn.textContent=e.Loc.getMessage("JS_UI_TOUR_BUTTON")}this.currentStepIndex--}},{key:"getPopup",value:function t(){var e=this;if(this.popup===null){this.popup=new BX.PopupWindow({content:this.getContent(),bindElement:this.getCurrentStep().getTarget(),className:"popup-window-ui-tour popup-window-ui-tour-opacity",offsetTop:15,offsetLeft:30,maxWidth:420,minWidth:420,closeIcon:true,bindOptions:{forceTop:true,forceLeft:true,forceBindPosition:true},events:{onPopupClose:function t(){e.close()}}})}return this.popup}},{key:"getContent",value:function t(){if(!this.layout.content){this.layout.content=e.Tag.render(f(),this.getTitle(),this.getText(),this.getLink(),this.getCounterItems(),this.getCurrentCounter(),this.getBtnContainer())}return this.layout.content}},{key:"setPopupData",value:function t(){e.Event.unbindAll(this.layout.link,"click");this.getTitle().innerHTML=this.getCurrentStep().getTitle();this.getText().innerHTML=this.getCurrentStep().getText();this.getLink().setAttribute("href",this.getCurrentStep().getLink());if(this.getCurrentStep().getArticle()){e.Event.bind(this.layout.link,"click",this.handleClickLink.bind(this))}this.getCurrentCounter().textContent=e.Loc.getMessage("JS_UI_TOUR_STEP_INDEX_TEXT").replace("#NUMBER#",this.currentStepIndex+1).replace("#NUMBER_TOTAL#",this.steps.length);for(var n=0;n<this.steps.length;n++){if(this.layout.counterItems[n]){e.Dom.removeClass(this.layout.counterItems[n],"ui-tour-popup-index-item-current");e.Dom.removeClass(this.layout.counterItems[n],"ui-tour-popup-index-item-passed")}if(n===this.currentStepIndex){e.Dom.addClass(this.layout.counterItems[n],"ui-tour-popup-index-item-current")}else if(n<this.currentStepIndex){e.Dom.addClass(this.layout.counterItems[n],"ui-tour-popup-index-item-passed")}}this.setPopupPosition()}},{key:"handleClickLink",value:function t(){event.preventDefault();BX.Helper.show("redirect=detail&code="+this.getCurrentStep().getArticle())}},{key:"getTitle",value:function t(){if(this.layout.title===null){this.layout.title=e.Tag.render(d())}return this.layout.title}},{key:"getText",value:function t(){if(this.layout.text===null){this.layout.text=e.Tag.render(g())}return this.layout.text}},{key:"getLink",value:function t(){if(this.layout.link===null){this.layout.link=e.Tag.render(c(),e.Loc.getMessage("JS_UI_TOUR_LINK"))}return this.layout.link}},{key:"getCurrentCounter",value:function t(){if(this.layout.currentCounter===null){this.layout.currentCounter=e.Tag.render(p(),e.Loc.getMessage("JS_UI_TOUR_STEP_INDEX_TEXT").replace("#NUMBER#",this.currentStepIndex+1).replace("#NUMBER_TOTAL#",this.steps.length))}return this.layout.currentCounter}},{key:"getBtnContainer",value:function t(){if(this.layout.btnContainer===null){this.layout.btnContainer=e.Tag.render(h());this.layout.nextBtn=e.Tag.render(a(),e.Loc.getMessage("JS_UI_TOUR_BUTTON"));this.layout.backBtn=e.Tag.render(l());e.Dom.append(this.layout.backBtn,this.layout.btnContainer);e.Dom.append(this.layout.nextBtn,this.layout.btnContainer);e.Event.bind(this.layout.nextBtn,"click",this.handleClickOnNextBtn.bind(this));e.Event.bind(this.layout.backBtn,"click",this.handleClickOnBackBtn.bind(this))}return this.layout.btnContainer}},{key:"getCounterItems",value:function t(){if(this.layout.counter===null){this.layout.counter=e.Tag.render(o())}this.layout.counterItems=[];for(var n=0;n<this.steps.length;n++){var i=e.Tag.render(s());this.layout.counterItems.push(i);e.Dom.append(i,this.layout.counter)}return this.layout.counter}},{key:"getCurrentStep",value:function t(){return this.steps[this.currentStepIndex]}},{key:"getPreviousStep",value:function t(){if(this.steps[this.currentStepIndex-1]){return this.steps[this.currentStepIndex-1]}}},{key:"handleClickOnNextBtn",value:function t(){e.Dom.addClass(this.layout.element,"ui-tour-overlay-element-opacity");e.Dom.addClass(this.popup.getPopupContainer(),"popup-window-ui-tour-opacity");this.clickOnBackBtn=false;if(this.getCurrentStep()){this.closeStep()}this.increaseCurrentStepIndex();if(this.getCurrentStep()&&this.getCurrentStep().getTarget()){e.Dom.addClass(this.getCurrentStep().getTarget(),"ui-tour-selector")}if(this.currentStepIndex===this.steps.length){if(this.finalStep){this.setFinalStep()}else{this.close()}}else{setTimeout(function(){this.showStep()}.bind(this),200);if(e.Dom.hasClass(this.layout.backBtn,"ui-tour-popup-btn-disabled")){e.Dom.removeClass(this.layout.backBtn,"ui-tour-popup-btn-disabled")}}}},{key:"handleClickOnBackBtn",value:function t(){e.Dom.addClass(this.layout.element,"ui-tour-overlay-element-opacity");e.Dom.addClass(this.popup.getPopupContainer(),"popup-window-ui-tour-opacity");this.closeStep();this.reduceCurrentStepIndex();if(this.currentStepIndex===0){e.Dom.addClass(this.layout.backBtn,"ui-tour-popup-btn-disabled")}this.clickOnBackBtn=true;setTimeout(function(){this.layout.backBtn.style.display="none";this.showStep()}.bind(this),200);if(this.getCurrentStep().getTarget()){e.Dom.addClass(this.getCurrentStep().getTarget(),"ui-tour-selector")}}},{key:"setFinalStep",value:function t(){this.layout.element.style.display="none";this.getPopup().destroy();var n=this.getFinalPopup();n.show();e.Dom.addClass(n.getPopupContainer(),"popup-window-ui-tour-final-show")}},{key:"getFinalPopup",value:function t(){this.popup=new BX.PopupWindow({content:this.getFinalContent(),className:"popup-window-ui-tour-final",offsetTop:15,offsetLeft:35,maxWidth:430,minWidth:300});return this.popup}},{key:"getFinalContent",value:function t(){if(!this.layout.finalContent){this.layout.finalContent=e.Tag.render(u(),this.finalTitle,this.finalText,this.getFinalBtn())}return this.layout.finalContent}},{key:"getFinalBtn",value:function t(){var n=[];if(this.buttons!==""){for(var u=0;u<this.buttons.length;u++){var s=e.Tag.render(r(),this.buttons[u].class,this.buttons[u].events.click,this.buttons[u].text);n.push(s)}}else{var o=e.Tag.render(i(),this.close.bind(this),e.Loc.getMessage("JS_UI_TOUR_BUTTON_CLOSE"));n.push(o)}return n}},{key:"isTargetVisible",value:function t(e){return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}},{key:"scrollToTarget",value:function t(e){window.scrollTo(0,e.top+window.pageYOffset-50)}},{key:"getFullEventName",value:function t(e){return"UI.Tour.Guide:"+e}}]);return v}(e.Event.EventEmitter);var m=function(){function t(){babelHelpers.classCallCheck(this,t);this.guides=new Map;this.autoStartQueue=[];this.currentGuide=null}babelHelpers.createClass(t,[{key:"create",value:function t(n){n=e.Type.isPlainObject(n)?n:{};var i=n.id;if(!e.Type.isString(i)&&i!==""){throw new Error("'id' parameter is required.")}if(this.get(i)){throw new Error("The tour instance with the same 'id' already exists.")}var r=new v(n);this.guides.set(r,true);return r}},{key:"add",value:function t(e){var n=this;var i=this.create(e);i.subscribe("UI.Tour.Guide:onFinish",function(){n.handleTourFinish(i)});if(!this.currentGuide){this.currentGuide=i;i.start()}else{this.autoStartQueue.push(i)}}},{key:"get",value:function t(e){return this.guides.get(e)}},{key:"remove",value:function t(e){this.guides.delete(e)}},{key:"getCurrentGuide",value:function t(){return this.currentGuide}},{key:"handleTourFinish",value:function t(e){this.currentGuide=null;this.remove(e.getId());var n=this.autoStartQueue.shift();if(n){this.currentGuide=n;n.start()}}}]);return t}();var b=new m;t.Guide=v;t.Step=n;t.Manager=b})(this.BX.UI.Tour=this.BX.UI.Tour||{},BX);
//# sourceMappingURL=tour.bundle.map.js