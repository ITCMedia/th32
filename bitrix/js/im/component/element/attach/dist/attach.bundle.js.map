{"version":3,"file":"attach.bundle.js","sources":["../src/types/delimiter.js","../src/types/file.js","../src/types/grid.js","../src/types/html.js","../src/types/image.js","../src/types/link.js","../src/types/message.js","../src/types/rich.js","../src/types/user.js","../src/attach.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Vue component\n *\n * Delimiter (attach type)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./delimiter.css\";\n\nexport const AttachTypeDelimiter =\n{\n\tproperty: 'DELIMITER',\n\tname: 'bx-messenger-element-attach-delimiter',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\tstyles()\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\twidth: this.config.DELIMITER.SIZE? this.config.DELIMITER.SIZE+'px': '',\n\t\t\t\t\tbackgroundColor: this.config.DELIMITER.COLOR? this.config.DELIMITER.COLOR: this.color,\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ttemplate: `<div class=\"bx-im-element-attach-type-delimiter\" :style=\"styles\">Delimiter</div>`\n\t},\n};","/**\n * Bitrix Messenger\n * Vue component\n *\n * File (attach type)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./file.css\";\nimport {Vue} from \"ui.vue\";\nimport {FilesModel} from \"im.model\";\nimport {Utils} from \"im.utils\";\n\nexport const AttachTypeFile =\n{\n\tproperty: 'FILE',\n\tname: 'bx-messenger-element-attach-file',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\topenLink(element)\n\t\t\t{\n\t\t\t\tif (element.LINK)\n\t\t\t\t{\n\t\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tapp.openNewPage(element.LINK);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.open(element.LINK, '_blank');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tfile()\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tname: this.config.FILE.NAME,\n\t\t\t\t\textension: this.config.FILE.NAME.split('.').splice(-1)[0],\n\t\t\t\t\tsize: this.config.FILE.SIZE,\n\t\t\t\t};\n\t\t\t},\n\t\t\tfileName(element)\n\t\t\t{\n\t\t\t\tlet maxLength = 70;\n\n\t\t\t\tif (!element.NAME || element.NAME.length < maxLength)\n\t\t\t\t{\n\t\t\t\t\treturn element.NAME;\n\t\t\t\t}\n\n\t\t\t\tlet endWordLength = 10;\n\n\t\t\t\tlet extension = element.NAME.split('.').splice(-1)[0];\n\t\t\t\tlet secondPart = element.NAME.substring(element.NAME.length-1 - (extension.length+1+endWordLength));\n\t\t\t\tlet firstPart = element.NAME.substring(0, maxLength-secondPart.length-3);\n\n\t\t\t\treturn firstPart.trim()+'...'+secondPart.trim();\n\t\t\t},\n\t\t\tfileNameFull(element)\n\t\t\t{\n\t\t\t\treturn Utils.text.htmlspecialcharsback(element.NAME);\n\t\t\t},\n\t\t\tfileSize(element)\n\t\t\t{\n\t\t\t\tlet size = element.SIZE;\n\n\t\t\t\tif (size <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tlet sizes = [\"BYTE\", \"KB\", \"MB\", \"GB\", \"TB\"];\n\t\t\t\tlet position = 0;\n\n\t\t\t\twhile (size >= 1024 && position < 4)\n\t\t\t\t{\n\t\t\t\t\tsize /= 1024;\n\t\t\t\t\tposition++;\n\t\t\t\t}\n\n\t\t\t\treturn Math.round(size) + \" \" + this.localize['IM_MESSENGER_ATTACH_FILE_SIZE_'+sizes[position]];\n\t\t\t},\n\t\t\tfileIcon(element)\n\t\t\t{\n\t\t\t\treturn FilesModel.getIconType(element.NAME.split('.').splice(-1)[0]);\n\t\t\t}\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\tlocalize()\n\t\t\t{\n\t\t\t\treturn Vue.getFilteredPhrases('IM_MESSENGER_ATTACH_FILE_', this.$root.$bitrixMessages);\n\t\t\t},\n\t\t},\n\t\ttemplate: `\n\t\t\t<div class=\"bx-im-element-attach-type-file-element\">\n\t\t\t\t<template v-for=\"(element, index) in config.FILE\">\n\t\t\t\t\t<div class=\"bx-im-element-attach-type-file\" @click=\"openLink(element)\">\n\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-file-icon\">\n\t\t\t\t\t\t\t<div :class=\"['ui-icon', 'ui-icon-file-'+fileIcon(element)]\"><i></i></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-file-block\">\n\t\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-file-name\" :title=\"fileNameFull(element)\">\n\t\t\t\t\t\t\t\t{{fileName(element)}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-file-size\">{{fileSize(element)}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t`\n\t},\n};","/**\n * Bitrix Messenger\n * Vue component\n *\n * Grid (attach type)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./grid.css\";\nimport {Utils} from \"im.utils\";\nimport {MessagesModel} from \"im.model\";\n\nexport const AttachTypeGrid =\n{\n\tproperty: 'GRID',\n\tname: 'bx-messenger-element-attach-grid',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t{\n\t\t\t\tthis.maxCellWith = Math.floor(Math.min(screen.availWidth, screen.availHeight)/4);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.maxCellWith = null;\n\t\t\t}\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\topenLink(element)\n\t\t\t{\n\t\t\t\tif (element.LINK)\n\t\t\t\t{\n\t\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tapp.openNewPage(element.LINK);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.open(element.LINK, '_blank');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// element.NETWORK_ID\n\t\t\t\t\t// element.USER_ID\n\t\t\t\t\t// element.CHAT_ID\n\t\t\t\t\t// TODO exec openDialog with params\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetWidth(element)\n\t\t\t{\n\t\t\t\tif (this.type !== 'row')\n\t\t\t\t{\n\t\t\t\t\treturn element.WIDTH? element.WIDTH+'px': '';\n\t\t\t\t}\n\n\t\t\t\tif (!element.VALUE)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (this.maxCellWith && element.WIDTH > this.maxCellWith)\n\t\t\t\t{\n\t\t\t\t\treturn this.maxCellWith+'px';\n\t\t\t\t}\n\n\t\t\t\treturn element.WIDTH? element.WIDTH+'px': '';\n\t\t\t},\n\n\t\t\tgetValue(element)\n\t\t\t{\n\t\t\t\tif (!element.VALUE)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn MessagesModel.decodeBbCode({text: element.VALUE});\n\t\t\t},\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\ttype()\n\t\t\t{\n\t\t\t\treturn this.config.GRID[0].DISPLAY.toLowerCase();\n\t\t\t},\n\t\t},\n\t\ttemplate: `\n\t\t\t<div class=\"bx-im-element-attach-type-grid\">\n\t\t\t\t<template v-if=\"type === 'block'\">\n\t\t\t\t\t<template v-for=\"(element, index) in config.GRID\">\n\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-display bx-im-element-attach-type-display-block\" :style=\"{width: getWidth(element)}\">\n\t\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-element-name\" v-html=\"element.NAME\"></div>\n\t\t\t\t\t\t\t<template v-if=\"element.LINK\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-element-value bx-im-element-attach-type-grid-element-value-link\" @click=\"openLink(element)\" v-html=\"getValue(element)\"></div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-element-value\" v-html=\"getValue(element)\"></div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\t\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if=\"type === 'line'\">\n\t\t\t\t\t<template v-for=\"(element, index) in config.GRID\">\n\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-display bx-im-element-attach-type-display-card\" :style=\"{width: getWidth(element)}\">\n\t\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-element-name\" v-html=\"element.NAME\"></div>\n\t\t\t\t\t\t\t<template v-if=\"element.LINK\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-element-value bx-im-element-attach-type-grid-element-value-link\" @click=\"openLink(element)\" v-html=\"getValue(element)\" :style=\"{color: element.COLOR? element.COLOR: ''}\"></div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-element-value\" v-html=\"getValue(element)\" :style=\"{color: element.COLOR? element.COLOR: ''}\"></div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if=\"type === 'row'\">\n\t\t\t\t\t<div class=\"bx-im-element-attach-type-grid-display bx-im-element-attach-type-display-column\">\n\t\t\t\t\t\t<table class=\"bx-im-element-attach-type-display-column-table\">\n\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t<template v-for=\"(element, index) in config.GRID\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<template v-if=\"element.NAME\">\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"bx-im-element-attach-type-grid-element-name\" :colspan=\"element.VALUE? 1: 2\" v-html=\"element.NAME\" :style=\"{width: getWidth(element)}\"></td>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t<template v-if=\"element.VALUE\">\n\t\t\t\t\t\t\t\t\t\t\t<template v-if=\"element.LINK\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"bx-im-element-attach-type-grid-element-value bx-im-element-attach-type-grid-element-value-link\" @click=\"openLink(element)\" v-html=\"getValue(element)\" :colspan=\"element.NAME? 1: 2\" :style=\"{color: element.COLOR? element.COLOR: ''}\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"bx-im-element-attach-type-grid-element-value\" v-html=\"getValue(element)\" :colspan=\"element.NAME? 1: 2\" :style=\"{color: element.COLOR? element.COLOR: ''}\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t`\n\t},\n};","/**\n * Bitrix Messenger\n * Vue component\n *\n * Rich Attach type\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./html.css\";\n\nexport const AttachTypeHtml =\n{\n\tproperty: 'HTML',\n\tname: 'bx-messenger-element-attach-html',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\ttemplate: `<div class=\"bx-im-element-attach-type-html\" v-html=\"config.HTML\"></div>`\n\t},\n};","/**\n * Bitrix Messenger\n * Vue component\n *\n * Image (attach type)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./image.css\";\nimport {Utils} from \"im.utils\";\n\nexport const AttachTypeImage =\n{\n\tproperty: 'IMAGE',\n\tname: 'bx-messenger-element-attach-image',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\topen(file)\n\t\t\t{\n\t\t\t\tif (!file)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t{\n\t\t\t\t\t// TODO add multiply\n\t\t\t\t\tBXMobileApp.UI.Photo.show({photos: [{url: file}], default_photo: file})\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(file, '_blank');\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetImageSize(width, height, maxWidth)\n\t\t\t{\n\t\t\t\tlet aspectRatio;\n\n\t\t\t\tif (width > maxWidth)\n\t\t\t\t{\n\t\t\t\t\taspectRatio = maxWidth / width;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\taspectRatio = 1;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\twidth: width * aspectRatio,\n\t\t\t\t\theight: height * aspectRatio\n\t\t\t\t};\n\t\t\t},\n\t\t\tgetElementSource(element)\n\t\t\t{\n\t\t\t\treturn element.PREVIEW? element.PREVIEW: element.LINK;\n\t\t\t},\n\t\t\tgetElementTitle(element)\n\t\t\t{\n\t\t\t\treturn Utils.text.htmlspecialcharsback(element.NAME);\n\t\t\t},\n\t\t\tlazyLoadCallback(event)\n\t\t\t{\n\t\t\t\tif (!event.element.style.width)\n\t\t\t\t{\n\t\t\t\t\tevent.element.style.width = event.element.offsetWidth+'px';\n\t\t\t\t}\n\t\t\t\tif (!event.element.style.height)\n\t\t\t\t{\n\t\t\t\t\tevent.element.style.height = event.element.offsetHeight+'px';\n\t\t\t\t}\n\t\t\t},\n\t\t\tstyleFileSizes(image)\n\t\t\t{\n\t\t\t\tif (!(image.WIDTH && image.HEIGHT))\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmaxHeight: '100%',\n\t\t\t\t\t\tbackgroundSize: 'contain'\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tlet sizes = this.getImageSize(image.WIDTH, image.HEIGHT, 250);\n\n\t\t\t\treturn {\n\t\t\t\t\twidth: sizes.width+'px',\n\t\t\t\t\theight: sizes.height+'px',\n\t\t\t\t\tbackgroundSize: sizes.width < 100 || sizes.height < 100? 'contain': 'initial'\n\t\t\t\t}\n\t\t\t},\n\t\t\tstyleBoxSizes(image)\n\t\t\t{\n\t\t\t\tif (!(image.WIDTH && image.HEIGHT))\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\theight: '150px'\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (parseInt(this.styleFileSizes(image).height) <= 250)\n\t\t\t\t{\n\t\t\t\t\treturn {};\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\theight: '280px'\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\ttemplate: `\n\t\t\t<div class=\"bx-im-element-attach-type-image\">\n\t\t\t\t<template v-for=\"(image, index) in config.IMAGE\">\n\t\t\t\t\t<div class=\"bx-im-element-attach-type-image-block\" @click=\"open(image.LINK)\" :style=\"styleBoxSizes(image)\" :key=\"index\">\n\t\t\t\t\t\t<img v-bx-lazyload=\"{callback: lazyLoadCallback}\"\n\t\t\t\t\t\t\tclass=\"bx-im-element-attach-type-image-source\"\n\t\t\t\t\t\t\t:data-lazyload-src=\"getElementSource(image)\"\n\t\t\t\t\t\t\t:style=\"styleFileSizes(image)\"\n\t\t\t\t\t\t\t:title=\"getElementTitle(image)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t`\n\t},\n};","/**\n * Bitrix Messenger\n * Vue component\n *\n * Link (attach type)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./link.css\";\nimport {AttachTypeImage} from \"./image\";\nimport {Utils} from \"im.utils\";\n\nexport const AttachTypeLink =\n{\n\tproperty: 'LINK',\n\tname: 'bx-messenger-element-attach-link',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\tgetImageConfig(element)\n\t\t\t{\n\t\t\t\treturn {IMAGE: [{\n\t\t\t\t\tNAME: element.NAME,\n\t\t\t\t\tPREVIEW: element.PREVIEW,\n\t\t\t\t\tWIDTH: element.WIDTH,\n\t\t\t\t\tHEIGHT: element.HEIGHT,\n\t\t\t\t}]};\n\t\t\t},\n\t\t\topenLink(element)\n\t\t\t{\n\t\t\t\tif (element.LINK)\n\t\t\t\t{\n\t\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tapp.openNewPage(element.LINK);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.open(element.LINK, '_blank');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// element.NETWORK_ID\n\t\t\t\t\t// element.USER_ID\n\t\t\t\t\t// element.CHAT_ID\n\t\t\t\t\t// TODO exec openDialog with params\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\timageComponentName()\n\t\t\t{\n\t\t\t\treturn AttachTypeImage.name;\n\t\t\t}\n\t\t},\n\t\tcomponents:\n\t\t{\n\t\t\t[AttachTypeImage.name]: AttachTypeImage.component\n\t\t},\n\t\ttemplate: `\n\t\t\t<div class=\"bx-im-element-attach-type-link\">\n\t\t\t\t<template v-for=\"(element, index) in config.LINK\">\n\t\t\t\t\t<div class=\"bx-im-element-attach-type-link-element\" :key=\"index\">\n\t\t\t\t\t\t<div v-if=\"element.PREVIEW\" class=\"bx-im-element-attach-type-link-image\" @click=\"openLink(element)\">\n\t\t\t\t\t\t\t<component :is=\"imageComponentName\" :config=\"getImageConfig(element)\" :color=\"color\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-link-name\" @click=\"openLink(element)\" v-html=\"element.NAME\"></div>\n\t\t\t\t\t\t<div v-if=\"element.DESC\" class=\"bx-im-element-attach-type-link-desc\" v-html=\"element.DESC\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t`\n\t},\n};","/**\n * Bitrix Messenger\n * Vue component\n *\n * Message (attach type)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {MessagesModel} from \"im.model\";\n\nexport const AttachTypeMessage =\n{\n\tproperty: 'MESSAGE',\n\tname: 'bx-messenger-element-attach-message',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\tmessage()\n\t\t\t{\n\t\t\t\treturn MessagesModel.decodeBbCode({text: this.config.MESSAGE});\n\t\t\t}\n\t\t},\n\t\ttemplate: `<div class=\"bx-im-element-attach-type-message\" v-html=\"message\"></div>`\n\t},\n};","/**\n * Bitrix Messenger\n * Vue component\n *\n * Rich (attach type)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./rich.css\";\nimport {AttachTypeImage} from \"./image\";\nimport {Utils} from \"im.utils\";\n\nexport const AttachTypeRich =\n{\n\tproperty: 'RICH_LINK',\n\tname: 'bx-messenger-element-attach-rich',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\tgetImageConfig(element)\n\t\t\t{\n\t\t\t\treturn {IMAGE: [{\n\t\t\t\t\tNAME: element.NAME,\n\t\t\t\t\tPREVIEW: element.PREVIEW,\n\t\t\t\t\tWIDTH: element.WIDTH,\n\t\t\t\t\tHEIGHT: element.HEIGHT,\n\t\t\t\t}]};\n\t\t\t},\n\t\t\topenLink(element)\n\t\t\t{\n\t\t\t\tif (element.LINK)\n\t\t\t\t{\n\t\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tapp.openNewPage(element.LINK);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.open(element.LINK, '_blank');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// element.NETWORK_ID\n\t\t\t\t\t// element.USER_ID\n\t\t\t\t\t// element.CHAT_ID\n\t\t\t\t\t// TODO exec openDialog with params\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\timageComponentName()\n\t\t\t{\n\t\t\t\treturn AttachTypeImage.name;\n\t\t\t}\n\t\t},\n\t\tcomponents:\n\t\t{\n\t\t\t[AttachTypeImage.name]: AttachTypeImage.component\n\t\t},\n\t\ttemplate: `\n\t\t\t<div class=\"bx-im-element-attach-type-rich\">\n\t\t\t\t<template v-for=\"(element, index) in config.RICH_LINK\">\n\t\t\t\t\t<div class=\"bx-im-element-attach-type-rich-element\" :key=\"index\">\n\t\t\t\t\t\t<div v-if=\"element.PREVIEW\" class=\"bx-im-element-attach-type-rich-image\" @click=\"openLink(element)\">\n\t\t\t\t\t\t\t<component :is=\"imageComponentName\" :config=\"getImageConfig(element)\" :color=\"color\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-rich-name\" @click=\"openLink(element)\" v-html=\"element.NAME\"></div>\n\t\t\t\t\t\t<div v-if=\"element.DESC\" class=\"bx-im-element-attach-type-rich-desc\" v-html=\"element.DESC\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t`\n\t},\n};","/**\n * Bitrix Messenger\n * Vue component\n *\n * User (Attach type)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport \"./user.css\";\nimport {Utils} from \"im.utils\";\n\nexport const AttachTypeUser =\n{\n\tproperty: 'USER',\n\tname: 'bx-messenger-element-attach-user',\n\tcomponent:\n\t{\n\t\tprops:\n\t\t{\n\t\t\tconfig: {type: Object, default: {}},\n\t\t\tcolor: {type: String, default: 'transparent'},\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\topenLink(element)\n\t\t\t{\n\t\t\t\tif (element.LINK)\n\t\t\t\t{\n\t\t\t\t\tif (Utils.platform.isBitrixMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tapp.openNewPage(element.LINK);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.open(element.LINK, '_blank');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// element.NETWORK_ID\n\t\t\t\t\t// element.USER_ID\n\t\t\t\t\t// element.CHAT_ID\n\t\t\t\t\t// TODO exec openDialog with params\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetAvatarType(element)\n\t\t\t{\n\t\t\t\tif (element.AVATAR)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tlet avatarType = 'user';\n\n\t\t\t\tif (element.AVATAR_TYPE === 'CHAT')\n\t\t\t\t{\n\t\t\t\t\tavatarType = 'chat';\n\t\t\t\t}\n\t\t\t\telse if (element.AVATAR_TYPE === 'BOT')\n\t\t\t\t{\n\t\t\t\t\tavatarType = 'bot';\n\t\t\t\t}\n\n\t\t\t\treturn 'bx-im-element-attach-type-user-avatar-type-'+avatarType;\n\t\t\t}\n\t\t},\n\t\ttemplate: `\n\t\t\t<div class=\"bx-im-element-attach-type-user\">\n\t\t\t\t<template v-for=\"(element, index) in config.USER\">\n\t\t\t\t\t<div class=\"bx-im-element-attach-type-user-body\" @click=\"openLink(element)\">\n\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-user-avatar\">\n\t\t\t\t\t\t\t<div :class=\"['bx-im-element-attach-type-user-avatar-type', getAvatarType(element)]\" :style=\"{backgroundColor: element.AVATAR? '': color}\">\n\t\t\t\t\t\t\t\t<img v-if=\"element.AVATAR\" \n\t\t\t\t\t\t\t\t\tv-bx-lazyload\n\t\t\t\t\t\t\t\t\tclass=\"bx-im-element-attach-type-user-avatar-source\"\n\t\t\t\t\t\t\t\t\t:data-lazyload-src=\"element.AVATAR\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-element-attach-type-user-name\" v-html=\"element.NAME\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t`\n\t},\n};","/**\n * Bitrix Messenger\n * Attach element Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './attach.css';\n\nimport {AttachTypeDelimiter} from './types/delimiter';\nimport {AttachTypeFile} from './types/file';\nimport {AttachTypeGrid} from './types/grid';\nimport {AttachTypeHtml} from './types/html';\nimport {AttachTypeImage} from './types/image';\nimport {AttachTypeLink} from './types/link';\nimport {AttachTypeMessage} from './types/message';\nimport {AttachTypeRich} from './types/rich';\nimport {AttachTypeUser} from './types/user';\n\nimport {Vue} from 'ui.vue';\n\nconst AttachTypes = [\n\tAttachTypeDelimiter,\n\tAttachTypeFile,\n\tAttachTypeGrid,\n\tAttachTypeHtml,\n\tAttachTypeImage,\n\tAttachTypeLink,\n\tAttachTypeMessage,\n\tAttachTypeRich,\n\tAttachTypeUser\n];\n\nconst AttachComponents = {};\nAttachTypes.forEach(attachType => {\n\tAttachComponents[attachType.name] = attachType.component;\n});\n\nVue.component('bx-messenger-element-attach',\n{\n\tprops:\n\t{\n\t\tconfig: {type: Object, default: {}},\n\t\tbaseColor: {type: String, default: '#17a3ea'},\n\t},\n\tmethods:\n\t{\n\t\tgetComponentForBlock(block)\n\t\t{\n\t\t\tfor (let attachType of AttachTypes)\n\t\t\t{\n\t\t\t\tif (typeof block[attachType.property] !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\treturn attachType.name;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn '';\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tcolor()\n\t\t{\n\t\t\tif (\n\t\t\t\ttypeof(this.config.COLOR) === 'undefined'\n\t\t\t\t|| !this.config.COLOR\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn this.baseColor;\n\t\t\t}\n\n\t\t\tif (this.config.COLOR === 'transparent')\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.config.COLOR;\n\t\t},\n\t},\n\tcomponents: AttachComponents,\n\ttemplate: `\n\t\t<div class=\"bx-im-element-attach\">\n\t\t\t<div v-if=\"color\" class=\"bx-im-element-attach-border\" :style=\"{borderColor: color}\"></div>\n\t\t\t<div class=\"bx-im-element-attach-content\">\n\t\t\t\t<template v-for=\"(block, index) in config.BLOCKS\">\n\t\t\t\t\t<component :is=\"getComponentForBlock(block)\" :config=\"block\" :color=\"color\" :key=\"index\" />\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`\n});"],"names":["AttachTypeDelimiter","property","name","component","props","config","type","Object","default","color","String","computed","styles","width","DELIMITER","SIZE","backgroundColor","COLOR","template","AttachTypeFile","methods","openLink","element","LINK","Utils","platform","isBitrixMobile","app","openNewPage","window","open","file","FILE","NAME","extension","split","splice","size","fileName","maxLength","length","endWordLength","secondPart","substring","firstPart","trim","fileNameFull","text","htmlspecialcharsback","fileSize","sizes","position","Math","round","localize","fileIcon","FilesModel","getIconType","Vue","getFilteredPhrases","$root","$bitrixMessages","AttachTypeGrid","created","maxCellWith","floor","min","screen","availWidth","availHeight","getWidth","WIDTH","VALUE","getValue","MessagesModel","decodeBbCode","GRID","DISPLAY","toLowerCase","AttachTypeHtml","AttachTypeImage","BXMobileApp","UI","Photo","show","photos","url","default_photo","getImageSize","height","maxWidth","aspectRatio","getElementSource","PREVIEW","getElementTitle","lazyLoadCallback","event","style","offsetWidth","offsetHeight","styleFileSizes","image","HEIGHT","maxHeight","backgroundSize","styleBoxSizes","parseInt","AttachTypeLink","getImageConfig","IMAGE","imageComponentName","components","AttachTypeMessage","message","MESSAGE","AttachTypeRich","AttachTypeUser","getAvatarType","AVATAR","avatarType","AVATAR_TYPE","AttachTypes","AttachComponents","forEach","attachType","baseColor","getComponentForBlock","block"],"mappings":";;;CAAA;;;;;;;;;;AAWA,CAEO,IAAMA,mBAAmB,GAChC;CACCC,EAAAA,QAAQ,EAAE,WADX;CAECC,EAAAA,IAAI,EAAE,uCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCG,IAAAA,QAAQ,EACR;CACCC,MAAAA,MADD,oBAEC;CACC,eAAO;CACNC,UAAAA,KAAK,EAAE,KAAKR,MAAL,CAAYS,SAAZ,CAAsBC,IAAtB,GAA4B,KAAKV,MAAL,CAAYS,SAAZ,CAAsBC,IAAtB,GAA2B,IAAvD,GAA6D,EAD9D;CAENC,UAAAA,eAAe,EAAE,KAAKX,MAAL,CAAYS,SAAZ,CAAsBG,KAAtB,GAA6B,KAAKZ,MAAL,CAAYS,SAAZ,CAAsBG,KAAnD,GAA0D,KAAKR;CAF1E,SAAP;CAIA;CAPF,KAPD;CAgBCS,IAAAA,QAAQ;CAhBT;CAJD,CADO;;CCbP;;;;;;;;;;AAWA,CAKO,IAAMC,cAAc,GAC3B;CACClB,EAAAA,QAAQ,EAAE,MADX;CAECC,EAAAA,IAAI,EAAE,kCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCY,IAAAA,OAAO,EACP;CACCC,MAAAA,QADD,oBACUC,OADV,EAEC;CACC,YAAIA,OAAO,CAACC,IAAZ,EACA;CACC,cAAIC,cAAK,CAACC,QAAN,CAAeC,cAAf,EAAJ,EACA;CACCC,YAAAA,GAAG,CAACC,WAAJ,CAAgBN,OAAO,CAACC,IAAxB;CACA,WAHD,MAKA;CACCM,YAAAA,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACC,IAApB,EAA0B,QAA1B;CACA;CACD;CACD,OAdF;CAeCQ,MAAAA,IAfD,kBAgBC;CACC,eAAO;CACN7B,UAAAA,IAAI,EAAE,KAAKG,MAAL,CAAY2B,IAAZ,CAAiBC,IADjB;CAENC,UAAAA,SAAS,EAAE,KAAK7B,MAAL,CAAY2B,IAAZ,CAAiBC,IAAjB,CAAsBE,KAAtB,CAA4B,GAA5B,EAAiCC,MAAjC,CAAwC,CAAC,CAAzC,EAA4C,CAA5C,CAFL;CAGNC,UAAAA,IAAI,EAAE,KAAKhC,MAAL,CAAY2B,IAAZ,CAAiBjB;CAHjB,SAAP;CAKA,OAtBF;CAuBCuB,MAAAA,QAvBD,oBAuBUhB,OAvBV,EAwBC;CACC,YAAIiB,SAAS,GAAG,EAAhB;;CAEA,YAAI,CAACjB,OAAO,CAACW,IAAT,IAAiBX,OAAO,CAACW,IAAR,CAAaO,MAAb,GAAsBD,SAA3C,EACA;CACC,iBAAOjB,OAAO,CAACW,IAAf;CACA;;CAED,YAAIQ,aAAa,GAAG,EAApB;CAEA,YAAIP,SAAS,GAAGZ,OAAO,CAACW,IAAR,CAAaE,KAAb,CAAmB,GAAnB,EAAwBC,MAAxB,CAA+B,CAAC,CAAhC,EAAmC,CAAnC,CAAhB;CACA,YAAIM,UAAU,GAAGpB,OAAO,CAACW,IAAR,CAAaU,SAAb,CAAuBrB,OAAO,CAACW,IAAR,CAAaO,MAAb,GAAoB,CAApB,IAAyBN,SAAS,CAACM,MAAV,GAAiB,CAAjB,GAAmBC,aAA5C,CAAvB,CAAjB;CACA,YAAIG,SAAS,GAAGtB,OAAO,CAACW,IAAR,CAAaU,SAAb,CAAuB,CAAvB,EAA0BJ,SAAS,GAACG,UAAU,CAACF,MAArB,GAA4B,CAAtD,CAAhB;CAEA,eAAOI,SAAS,CAACC,IAAV,KAAiB,KAAjB,GAAuBH,UAAU,CAACG,IAAX,EAA9B;CACA,OAvCF;CAwCCC,MAAAA,YAxCD,wBAwCcxB,OAxCd,EAyCC;CACC,eAAOE,cAAK,CAACuB,IAAN,CAAWC,oBAAX,CAAgC1B,OAAO,CAACW,IAAxC,CAAP;CACA,OA3CF;CA4CCgB,MAAAA,QA5CD,oBA4CU3B,OA5CV,EA6CC;CACC,YAAIe,IAAI,GAAGf,OAAO,CAACP,IAAnB;;CAEA,YAAIsB,IAAI,IAAI,CAAZ,EACA;CACC,iBAAO,EAAP;CACA;;CAED,YAAIa,KAAK,GAAG,CAAC,MAAD,EAAS,IAAT,EAAe,IAAf,EAAqB,IAArB,EAA2B,IAA3B,CAAZ;CACA,YAAIC,QAAQ,GAAG,CAAf;;CAEA,eAAOd,IAAI,IAAI,IAAR,IAAgBc,QAAQ,GAAG,CAAlC,EACA;CACCd,UAAAA,IAAI,IAAI,IAAR;CACAc,UAAAA,QAAQ;CACR;;CAED,eAAOC,IAAI,CAACC,KAAL,CAAWhB,IAAX,IAAmB,GAAnB,GAAyB,KAAKiB,QAAL,CAAc,mCAAiCJ,KAAK,CAACC,QAAD,CAApD,CAAhC;CACA,OA/DF;CAgECI,MAAAA,QAhED,oBAgEUjC,OAhEV,EAiEC;CACC,eAAOkC,mBAAU,CAACC,WAAX,CAAuBnC,OAAO,CAACW,IAAR,CAAaE,KAAb,CAAmB,GAAnB,EAAwBC,MAAxB,CAA+B,CAAC,CAAhC,EAAmC,CAAnC,CAAvB,CAAP;CACA;CAnEF,KAPD;CA4ECzB,IAAAA,QAAQ,EACR;CACC2C,MAAAA,QADD,sBAEC;CACC,eAAOI,UAAG,CAACC,kBAAJ,CAAuB,2BAAvB,EAAoD,KAAKC,KAAL,CAAWC,eAA/D,CAAP;CACA;CAJF,KA7ED;CAmFC3C,IAAAA,QAAQ;CAnFT;CAJD,CADO;;CChBP;;;;;;;;;;AAWA,CAIO,IAAM4C,cAAc,GAC3B;CACC7D,EAAAA,QAAQ,EAAE,MADX;CAECC,EAAAA,IAAI,EAAE,kCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCuD,IAAAA,OAND,qBAOC;CACC,UAAIvC,cAAK,CAACC,QAAN,CAAeC,cAAf,EAAJ,EACA;CACC,aAAKsC,WAAL,GAAmBZ,IAAI,CAACa,KAAL,CAAWb,IAAI,CAACc,GAAL,CAASC,MAAM,CAACC,UAAhB,EAA4BD,MAAM,CAACE,WAAnC,IAAgD,CAA3D,CAAnB;CACA,OAHD,MAKA;CACC,aAAKL,WAAL,GAAmB,IAAnB;CACA;CACD,KAhBF;CAiBC5C,IAAAA,OAAO,EACP;CACCC,MAAAA,QADD,oBACUC,OADV,EAEC;CACC,YAAIA,OAAO,CAACC,IAAZ,EACA;CACC,cAAIC,cAAK,CAACC,QAAN,CAAeC,cAAf,EAAJ,EACA;CACCC,YAAAA,GAAG,CAACC,WAAJ,CAAgBN,OAAO,CAACC,IAAxB;CACA,WAHD,MAKA;CACCM,YAAAA,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACC,IAApB,EAA0B,QAA1B;CACA;CACD,SAVD;CAkBA,OArBF;CAsBC+C,MAAAA,QAtBD,oBAsBUhD,OAtBV,EAuBC;CACC,YAAI,KAAKhB,IAAL,KAAc,KAAlB,EACA;CACC,iBAAOgB,OAAO,CAACiD,KAAR,GAAejD,OAAO,CAACiD,KAAR,GAAc,IAA7B,GAAmC,EAA1C;CACA;;CAED,YAAI,CAACjD,OAAO,CAACkD,KAAb,EACA;CACC,iBAAO,KAAP;CACA;;CAED,YAAI,KAAKR,WAAL,IAAoB1C,OAAO,CAACiD,KAAR,GAAgB,KAAKP,WAA7C,EACA;CACC,iBAAO,KAAKA,WAAL,GAAiB,IAAxB;CACA;;CAED,eAAO1C,OAAO,CAACiD,KAAR,GAAejD,OAAO,CAACiD,KAAR,GAAc,IAA7B,GAAmC,EAA1C;CACA,OAxCF;CA0CCE,MAAAA,QA1CD,oBA0CUnD,OA1CV,EA2CC;CACC,YAAI,CAACA,OAAO,CAACkD,KAAb,EACA;CACC,iBAAO,EAAP;CACA;;CAED,eAAOE,sBAAa,CAACC,YAAd,CAA2B;CAAC5B,UAAAA,IAAI,EAAEzB,OAAO,CAACkD;CAAf,SAA3B,CAAP;CACA;CAlDF,KAlBD;CAsEC7D,IAAAA,QAAQ,EACR;CACCL,MAAAA,IADD,kBAEC;CACC,eAAO,KAAKD,MAAL,CAAYuE,IAAZ,CAAiB,CAAjB,EAAoBC,OAApB,CAA4BC,WAA5B,EAAP;CACA;CAJF,KAvED;CA6EC5D,IAAAA,QAAQ;CA7ET;CAJD,CADO;;CCfP;;;;;;;;;;AAWA,CAEO,IAAM6D,cAAc,GAC3B;CACC9E,EAAAA,QAAQ,EAAE,MADX;CAECC,EAAAA,IAAI,EAAE,kCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCU,IAAAA,QAAQ;CANT;CAJD,CADO;;CCbP;;;;;;;;;;AAWA,CAGO,IAAM8D,eAAe,GAC5B;CACC/E,EAAAA,QAAQ,EAAE,OADX;CAECC,EAAAA,IAAI,EAAE,mCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCY,IAAAA,OAAO,EACP;CACCU,MAAAA,IADD,gBACMC,IADN,EAEC;CACC,YAAI,CAACA,IAAL,EACA;CACC,iBAAO,KAAP;CACA;;CAED,YAAIP,cAAK,CAACC,QAAN,CAAeC,cAAf,EAAJ,EACA;CACC;CACAuD,UAAAA,WAAW,CAACC,EAAZ,CAAeC,KAAf,CAAqBC,IAArB,CAA0B;CAACC,YAAAA,MAAM,EAAE,CAAC;CAACC,cAAAA,GAAG,EAAEvD;CAAN,aAAD,CAAT;CAAwBwD,YAAAA,aAAa,EAAExD;CAAvC,WAA1B;CACA,SAJD,MAMA;CACCF,UAAAA,MAAM,CAACC,IAAP,CAAYC,IAAZ,EAAkB,QAAlB;CACA;CACD,OAjBF;CAkBCyD,MAAAA,YAlBD,wBAkBc3E,KAlBd,EAkBqB4E,MAlBrB,EAkB6BC,QAlB7B,EAmBC;CACC,YAAIC,WAAJ;;CAEA,YAAI9E,KAAK,GAAG6E,QAAZ,EACA;CACCC,UAAAA,WAAW,GAAGD,QAAQ,GAAG7E,KAAzB;CACA,SAHD,MAKA;CACC8E,UAAAA,WAAW,GAAG,CAAd;CACA;;CAED,eAAO;CACN9E,UAAAA,KAAK,EAAEA,KAAK,GAAG8E,WADT;CAENF,UAAAA,MAAM,EAAEA,MAAM,GAAGE;CAFX,SAAP;CAIA,OAnCF;CAoCCC,MAAAA,gBApCD,4BAoCkBtE,OApClB,EAqCC;CACC,eAAOA,OAAO,CAACuE,OAAR,GAAiBvE,OAAO,CAACuE,OAAzB,GAAkCvE,OAAO,CAACC,IAAjD;CACA,OAvCF;CAwCCuE,MAAAA,eAxCD,2BAwCiBxE,OAxCjB,EAyCC;CACC,eAAOE,cAAK,CAACuB,IAAN,CAAWC,oBAAX,CAAgC1B,OAAO,CAACW,IAAxC,CAAP;CACA,OA3CF;CA4CC8D,MAAAA,gBA5CD,4BA4CkBC,KA5ClB,EA6CC;CACC,YAAI,CAACA,KAAK,CAAC1E,OAAN,CAAc2E,KAAd,CAAoBpF,KAAzB,EACA;CACCmF,UAAAA,KAAK,CAAC1E,OAAN,CAAc2E,KAAd,CAAoBpF,KAApB,GAA4BmF,KAAK,CAAC1E,OAAN,CAAc4E,WAAd,GAA0B,IAAtD;CACA;;CACD,YAAI,CAACF,KAAK,CAAC1E,OAAN,CAAc2E,KAAd,CAAoBR,MAAzB,EACA;CACCO,UAAAA,KAAK,CAAC1E,OAAN,CAAc2E,KAAd,CAAoBR,MAApB,GAA6BO,KAAK,CAAC1E,OAAN,CAAc6E,YAAd,GAA2B,IAAxD;CACA;CACD,OAtDF;CAuDCC,MAAAA,cAvDD,0BAuDgBC,KAvDhB,EAwDC;CACC,YAAI,EAAEA,KAAK,CAAC9B,KAAN,IAAe8B,KAAK,CAACC,MAAvB,CAAJ,EACA;CACC,iBAAO;CACNC,YAAAA,SAAS,EAAE,MADL;CAENC,YAAAA,cAAc,EAAE;CAFV,WAAP;CAIA;;CAED,YAAItD,KAAK,GAAG,KAAKsC,YAAL,CAAkBa,KAAK,CAAC9B,KAAxB,EAA+B8B,KAAK,CAACC,MAArC,EAA6C,GAA7C,CAAZ;CAEA,eAAO;CACNzF,UAAAA,KAAK,EAAEqC,KAAK,CAACrC,KAAN,GAAY,IADb;CAEN4E,UAAAA,MAAM,EAAEvC,KAAK,CAACuC,MAAN,GAAa,IAFf;CAGNe,UAAAA,cAAc,EAAEtD,KAAK,CAACrC,KAAN,GAAc,GAAd,IAAqBqC,KAAK,CAACuC,MAAN,GAAe,GAApC,GAAyC,SAAzC,GAAoD;CAH9D,SAAP;CAKA,OAxEF;CAyECgB,MAAAA,aAzED,yBAyEeJ,KAzEf,EA0EC;CACC,YAAI,EAAEA,KAAK,CAAC9B,KAAN,IAAe8B,KAAK,CAACC,MAAvB,CAAJ,EACA;CACC,iBAAO;CACNb,YAAAA,MAAM,EAAE;CADF,WAAP;CAGA;;CAED,YAAIiB,QAAQ,CAAC,KAAKN,cAAL,CAAoBC,KAApB,EAA2BZ,MAA5B,CAAR,IAA+C,GAAnD,EACA;CACC,iBAAO,EAAP;CACA;;CAED,eAAO;CACNA,UAAAA,MAAM,EAAE;CADF,SAAP;CAGA;CA1FF,KAPD;CAmGCvE,IAAAA,QAAQ;CAnGT;CAJD,CADO;;CCdP;;;;;;;;;;AAWA,CAIO,IAAMyF,cAAc,GAC3B;CACC1G,EAAAA,QAAQ,EAAE,MADX;CAECC,EAAAA,IAAI,EAAE,kCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCY,IAAAA,OAAO,EACP;CACCwF,MAAAA,cADD,0BACgBtF,OADhB,EAEC;CACC,eAAO;CAACuF,UAAAA,KAAK,EAAE,CAAC;CACf5E,YAAAA,IAAI,EAAEX,OAAO,CAACW,IADC;CAEf4D,YAAAA,OAAO,EAAEvE,OAAO,CAACuE,OAFF;CAGftB,YAAAA,KAAK,EAAEjD,OAAO,CAACiD,KAHA;CAIf+B,YAAAA,MAAM,EAAEhF,OAAO,CAACgF;CAJD,WAAD;CAAR,SAAP;CAMA,OATF;CAUCjF,MAAAA,QAVD,oBAUUC,OAVV,EAWC;CACC,YAAIA,OAAO,CAACC,IAAZ,EACA;CACC,cAAIC,cAAK,CAACC,QAAN,CAAeC,cAAf,EAAJ,EACA;CACCC,YAAAA,GAAG,CAACC,WAAJ,CAAgBN,OAAO,CAACC,IAAxB;CACA,WAHD,MAKA;CACCM,YAAAA,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACC,IAApB,EAA0B,QAA1B;CACA;CACD,SAVD;CAkBA;CA9BF,KAPD;CAuCCZ,IAAAA,QAAQ,EACR;CACCmG,MAAAA,kBADD,gCAEC;CACC,eAAO9B,eAAe,CAAC9E,IAAvB;CACA;CAJF,KAxCD;CA8CC6G,IAAAA,UAAU,kCAER/B,eAAe,CAAC9E,IAFR,EAEe8E,eAAe,CAAC7E,SAF/B,CA9CX;CAkDCe,IAAAA,QAAQ;CAlDT;CAJD,CADO;;CCfP;;;;;;;;;;AAWA,CAEO,IAAM8F,iBAAiB,GAC9B;CACC/G,EAAAA,QAAQ,EAAE,SADX;CAECC,EAAAA,IAAI,EAAE,qCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCG,IAAAA,QAAQ,EACR;CACCsG,MAAAA,OADD,qBAEC;CACC,eAAOvC,sBAAa,CAACC,YAAd,CAA2B;CAAC5B,UAAAA,IAAI,EAAE,KAAK1C,MAAL,CAAY6G;CAAnB,SAA3B,CAAP;CACA;CAJF,KAPD;CAaChG,IAAAA,QAAQ;CAbT;CAJD,CADO;;CCbP;;;;;;;;;;AAWA,CAIO,IAAMiG,cAAc,GAC3B;CACClH,EAAAA,QAAQ,EAAE,WADX;CAECC,EAAAA,IAAI,EAAE,kCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCY,IAAAA,OAAO,EACP;CACCwF,MAAAA,cADD,0BACgBtF,OADhB,EAEC;CACC,eAAO;CAACuF,UAAAA,KAAK,EAAE,CAAC;CACf5E,YAAAA,IAAI,EAAEX,OAAO,CAACW,IADC;CAEf4D,YAAAA,OAAO,EAAEvE,OAAO,CAACuE,OAFF;CAGftB,YAAAA,KAAK,EAAEjD,OAAO,CAACiD,KAHA;CAIf+B,YAAAA,MAAM,EAAEhF,OAAO,CAACgF;CAJD,WAAD;CAAR,SAAP;CAMA,OATF;CAUCjF,MAAAA,QAVD,oBAUUC,OAVV,EAWC;CACC,YAAIA,OAAO,CAACC,IAAZ,EACA;CACC,cAAIC,cAAK,CAACC,QAAN,CAAeC,cAAf,EAAJ,EACA;CACCC,YAAAA,GAAG,CAACC,WAAJ,CAAgBN,OAAO,CAACC,IAAxB;CACA,WAHD,MAKA;CACCM,YAAAA,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACC,IAApB,EAA0B,QAA1B;CACA;CACD,SAVD;CAkBA;CA9BF,KAPD;CAuCCZ,IAAAA,QAAQ,EACR;CACCmG,MAAAA,kBADD,gCAEC;CACC,eAAO9B,eAAe,CAAC9E,IAAvB;CACA;CAJF,KAxCD;CA8CC6G,IAAAA,UAAU,kCAER/B,eAAe,CAAC9E,IAFR,EAEe8E,eAAe,CAAC7E,SAF/B,CA9CX;CAkDCe,IAAAA,QAAQ;CAlDT;CAJD,CADO;;CCfP;;;;;;;;;;AAWA,CAGO,IAAMkG,cAAc,GAC3B;CACCnH,EAAAA,QAAQ,EAAE,MADX;CAECC,EAAAA,IAAI,EAAE,kCAFP;CAGCC,EAAAA,SAAS,EACT;CACCC,IAAAA,KAAK,EACL;CACCC,MAAAA,MAAM,EAAE;CAACC,QAAAA,IAAI,EAAEC,MAAP;CAAeC,QAAAA,OAAO,EAAE;CAAxB,OADT;CAECC,MAAAA,KAAK,EAAE;CAACH,QAAAA,IAAI,EAAEI,MAAP;CAAeF,QAAAA,OAAO,EAAE;CAAxB;CAFR,KAFD;CAMCY,IAAAA,OAAO,EACP;CACCC,MAAAA,QADD,oBACUC,OADV,EAEC;CACC,YAAIA,OAAO,CAACC,IAAZ,EACA;CACC,cAAIC,cAAK,CAACC,QAAN,CAAeC,cAAf,EAAJ,EACA;CACCC,YAAAA,GAAG,CAACC,WAAJ,CAAgBN,OAAO,CAACC,IAAxB;CACA,WAHD,MAKA;CACCM,YAAAA,MAAM,CAACC,IAAP,CAAYR,OAAO,CAACC,IAApB,EAA0B,QAA1B;CACA;CACD,SAVD;CAkBA,OArBF;CAsBC8F,MAAAA,aAtBD,yBAsBe/F,OAtBf,EAuBC;CACC,YAAIA,OAAO,CAACgG,MAAZ,EACA;CACC,iBAAO,EAAP;CACA;;CAED,YAAIC,UAAU,GAAG,MAAjB;;CAEA,YAAIjG,OAAO,CAACkG,WAAR,KAAwB,MAA5B,EACA;CACCD,UAAAA,UAAU,GAAG,MAAb;CACA,SAHD,MAIK,IAAIjG,OAAO,CAACkG,WAAR,KAAwB,KAA5B,EACL;CACCD,UAAAA,UAAU,GAAG,KAAb;CACA;;CAED,eAAO,gDAA8CA,UAArD;CACA;CAzCF,KAPD;CAkDCrG,IAAAA,QAAQ;CAlDT;CAJD,CADO;;CCdP;;;;;;;;AASA,CAcA,IAAMuG,WAAW,GAAG,CACnBzH,mBADmB,EAEnBmB,cAFmB,EAGnB2C,cAHmB,EAInBiB,cAJmB,EAKnBC,eALmB,EAMnB2B,cANmB,EAOnBK,iBAPmB,EAQnBG,cARmB,EASnBC,cATmB,CAApB;CAYA,IAAMM,gBAAgB,GAAG,EAAzB;CACAD,WAAW,CAACE,OAAZ,CAAoB,UAAAC,UAAU,EAAI;CACjCF,EAAAA,gBAAgB,CAACE,UAAU,CAAC1H,IAAZ,CAAhB,GAAoC0H,UAAU,CAACzH,SAA/C;CACA,CAFD;AAIAuD,WAAG,CAACvD,SAAJ,CAAc,6BAAd,EACA;CACCC,EAAAA,KAAK,EACL;CACCC,IAAAA,MAAM,EAAE;CAACC,MAAAA,IAAI,EAAEC,MAAP;CAAeC,MAAAA,OAAO,EAAE;CAAxB,KADT;CAECqH,IAAAA,SAAS,EAAE;CAACvH,MAAAA,IAAI,EAAEI,MAAP;CAAeF,MAAAA,OAAO,EAAE;CAAxB;CAFZ,GAFD;CAMCY,EAAAA,OAAO,EACP;CACC0G,IAAAA,oBADD,gCACsBC,KADtB,EAEC;CACC,sCAAuBN,WAAvB,kCACA;CADK,YAAIG,UAAU,mBAAd;;CAEJ,YAAI,OAAOG,KAAK,CAACH,UAAU,CAAC3H,QAAZ,CAAZ,KAAsC,WAA1C,EACA;CACC,iBAAO2H,UAAU,CAAC1H,IAAlB;CACA;CACD;;CAED,aAAO,EAAP;CACA;CAZF,GAPD;CAqBCS,EAAAA,QAAQ,EACR;CACCF,IAAAA,KADD,mBAEC;CACC,UACC,OAAO,KAAKJ,MAAL,CAAYY,KAAnB,KAA8B,WAA9B,IACG,CAAC,KAAKZ,MAAL,CAAYY,KAFjB,EAIA;CACC,eAAO,KAAK4G,SAAZ;CACA;;CAED,UAAI,KAAKxH,MAAL,CAAYY,KAAZ,KAAsB,aAA1B,EACA;CACC,eAAO,EAAP;CACA;;CAED,aAAO,KAAKZ,MAAL,CAAYY,KAAnB;CACA;CAjBF,GAtBD;CAyCC8F,EAAAA,UAAU,EAAEW,gBAzCb;CA0CCxG,EAAAA,QAAQ;CA1CT,CADA;;;;"}